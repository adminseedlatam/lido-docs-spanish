# Salidas de validadores y penalizaciones

El protocolo Lido ha establecido la política sobre el orden de salida de los validadores, las expectativas de rendimiento a lo largo del tiempo, las responsabilidades de los operadores de nodos, y la monitorización y penalizaciones. Las salidas de los validadores deben ser determinísticas e independientes para garantizar la confianza, y el orden de salida propuesto actualmente es el "enfoque combinado". Inicialmente, los mecanismos de ejecución y las expectativas de nivel de servicio son lo suficientemente suaves como para resolver problemas iniciales sin penalizaciones irrazonables, pero las penalizaciones por falta de rendimiento deben aumentar una vez que los procesos y mecanismos maduren. Los operadores de nodos tienen el deber de salir a los validadores de manera correcta y oportuna, y las herramientas para el procesamiento semi o completamente automatizado de solicitudes de salida de validadores incluyen el servicio de API de Claves, los informes del Oráculo de Ejector y el Ejector de Validadores. Los operadores de nodos deben adherirse a los niveles de servicio requeridos para las salidas de validadores, o corren el riesgo de ser clasificados como retrasados o morosos.

Se ha implementado una herramienta denominada "Monitor Daemon" para conciliar las solicitudes de salida de validadores señaladas con las salidas procesadas por la Capa de Consenso de Ethereum para determinar si los validadores han sido retirados de manera oportuna. Los resultados de este monitoreo están disponibles públicamente para asegurar que la DAO tenga acceso a los datos necesarios para comprender la tasa, flujo y eficacia de las salidas de validadores.

Aunque el proceso puede ser en gran parte automatizado, para tener en cuenta diferencias en infraestructura, horas de trabajo y tiempos de mecanismo, se establecen los siguientes niveles de servicio requeridos para las salidas de validadores a los cuales los operadores de nodos deben adherirse.

Si los operadores de nodos están procesando las solicitudes de salida de validadores señaladas tan pronto como están disponibles, el tiempo más corto posible para que una solicitud de salida de validador pase de "señalada" a "procesada" estará en algún lugar dentro del rango de unos pocos minutos a una hora. Con respecto al rendimiento de la salida de validadores, cada operador de nodo puede ser considerado con uno de los siguientes tres estados.

- En buen estado - las solicitudes de salida de validadores se procesan completamente, correctamente y puntualmente.
- Retrasado - las solicitudes de salida de validadores se procesan de manera incompleta, incorrecta o no dentro del marco de tiempo deseado.
- Moroso - las solicitudes de salida de validadores se procesan de manera incompleta, incorrecta o no dentro del marco de tiempo máximo aceptable.

| Evento                                                                                      | Requisito para no ser considerado Retrasado                                    | Requisito para no ser considerado Moroso                                                 |
| ------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------ | ---------------------------------------------------------------------------------------- |
| Procesamiento de solicitudes de salida de validadores señaladas                             | Todas las solicitudes señaladas se procesan lo antes posible (no más de 1 día) | Algunas solicitudes señaladas están tardando más de 1 pero menos de 4 días en procesarse |
| Escalación de incapacidad para ejecutar solicitud de salida de validador señalada con razón | Lo antes posible pero no más de 1 día                                          | Lo antes posible pero no más de 4 días                                                   |

En caso de que los operadores de nodos no estén procesando las solicitudes de salida de validadores de manera oportuna, se tomarán las siguientes acciones:
Si un operador de nodo tiene un estado de Retrasado, se debe plantear un problema en las comunicaciones internas con el operador de nodo y solicitar acción correctiva.

- Si un operador de nodo tiene un estado de Moroso, los contribuyentes de la DAO pueden plantear un problema formal con el operador de nodo en el foro de investigación de Lido. Mientras un operador de nodo tenga un estado de Moroso:
  - No se asignará automáticamente nueva participación al operador de nodo;
  - Las recompensas diarias enviadas al operador de nodo se reducirán a la mitad (con la mitad restante enviada hacia el rebase de ese día) (esto ocurre automáticamente);
  - Las recompensas reducidas continuarán durante la duración de un período de enfriamiento lo suficientemente largo como para determinar si, inmediatamente después de la restauración del servicio por parte del operador de nodo, las solicitudes de salida de validadores recibidas posteriormente se procesan de manera oportuna.
- Si un operador de nodo tiene un estado de Retrasado o Moroso, el módulo fuera de la cadena [Validators Exit Bus](./validator-exit-bus.md) Oracle asumirá que el operador de nodo no responde y reenrutará nuevas solicitudes de salida de validadores a operadores que no sean considerados morosos. Debido al reenrutamiento de solicitudes de salida de validadores, la DAO deberá considerar (mediante una votación ad-hoc) anular el límite total de validadores activos para el operador de nodo relevante de manera que si/cuando vuelvan a tener un estado de buen estado, no se beneficien a expensas de operadores de nodo que hayan asumido el procesamiento de las solicitudes reenrutadas.
- Una vez que un operador de nodo moroso haya procesado todas las solicitudes de salida de validadores señaladas (y así se actualice su número de validadores morosos en el siguiente informe del Oráculo de Contabilidad a 0), volverán a recibir solicitudes de salida de validadores. Su estado se revertirá a "En buen estado" después de 5 días (es decir, siempre que las nuevas solicitudes de salida de validadores recibidas se procesen de manera oportuna). Durante este período de "enfriamiento" de 5 días, continuarán sin recibir nueva participación y recibirán recompensas reducidas.
- En los casos más graves (por ejemplo, morosidad durante semanas), la DAO puede considerar una votación en cadena para "detener" al operador de nodo, lo que tiene el efecto de establecer en cero las tarifas que reciben (la DAO puede considerar tal votación en cualquier momento). Si el operador de nodo no responde a las solicitudes de la DAO, entonces se considera que el operador de nodo ha sido efectivamente "dado de baja" del protocolo Lido y la DAO debe tomar más medidas para formalizar la salida del operador de nodo.

En el caso de que un operador de nodo no pueda, por cualquier motivo, retirar a un validador (por ejemplo, pérdida de la clave privada asociada con ese validador), se espera que reembolse a los participantes del protocolo proporcionando el saldo máximo irrecuperable del validador (es decir, 32 ETH, ya que cualquier cantidad superior se puede obtener a través de recompensas parciales). Hacerlo convierte al validador en cuestión en "irrecuperable y reembolsado" y no cuenta en contra del operador de nodo en términos de evaluar su estado de solicitud de salida de validador.

#### Enlaces útiles

- [Política de Salidas de Validadores de Lido](https://github.com/lidofinance/documents-and-policies/blob/main/Lido%20on%20Ethereum%20-%20Validator%20Exits%20Policy.md)
- [Política de Salidas de Validadores de Lido: Discusión en el foro](https://research.lido.fi/t/lido-validator-exits-policy-draft-for-discussion/3864)
- [Retiros: sobre el orden de salida de validadores](https://research.lido.fi/t/withdrawals-on-validator-exiting-order/3048/1)
