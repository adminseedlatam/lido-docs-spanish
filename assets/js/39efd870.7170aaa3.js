"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[2951],{8751:(e,s,n)=>{n.r(s),n.d(s,{assets:()=>o,contentTitle:()=>r,default:()=>u,frontMatter:()=>i,metadata:()=>l,toc:()=>c});var a=n(4848),d=n(8453);const i={},r="ValidatorsExitBusOracle",l={id:"contracts/validators-exit-bus-oracle",title:"ValidatorsExitBusOracle",description:"- C\xf3digo fuente",source:"@site/docs/contracts/validators-exit-bus-oracle.md",sourceDirName:"contracts",slug:"/contracts/validators-exit-bus-oracle",permalink:"/contracts/validators-exit-bus-oracle",draft:!1,unlisted:!1,editUrl:"https://github.com/adminseedlatam/lido-docs-spanish/edit/main/docs/contracts/validators-exit-bus-oracle.md",tags:[],version:"current",frontMatter:{},sidebar:"docs",previous:{title:"AccountingOracle",permalink:"/contracts/accounting-oracle"},next:{title:"hash-consensus",permalink:"/contracts/hash-consensus"}},o={},c=[{value:"\xbfQu\xe9 es ValidatorsExitBusOracle?",id:"qu\xe9-es-validatorsexitbusoracle",level:2},{value:"Ciclo del informe",id:"ciclo-del-informe",level:2},{value:"Datos del informe",id:"datos-del-informe",level:2},{value:"Constantes",id:"constantes",level:2},{value:"DATA_FORMAT_LIST()",id:"data_format_list",level:3},{value:"SECONDS_PER_SLOT()",id:"seconds_per_slot",level:3},{value:"GENESIS_TIME()",id:"genesis_time",level:3},{value:"PAUSE_INFINITELY()",id:"pause_infinitely",level:3},{value:"ProcessingState",id:"processingstate",level:2},{value:"M\xe9todos de vista",id:"m\xe9todos-de-vista",level:2},{value:"getTotalRequestsProcessed()",id:"gettotalrequestsprocessed",level:3},{value:"getLastRequestedValidatorIndices()",id:"getlastrequestedvalidatorindices",level:3},{value:"Par\xe1metros",id:"par\xe1metros",level:4},{value:"Reversiones",id:"reversiones",level:4},{value:"getProcessingState()",id:"getprocessingstate",level:3},{value:"getConsensusContract()",id:"getconsensuscontract",level:3},{value:"getConsensusReport()",id:"getconsensusreport",level:3},{value:"getConsensusVersion()",id:"getconsensusversion",level:3},{value:"getContractVersion()",id:"getcontractversion",level:3},{value:"getLastProcessingRefSlot()",id:"getlastprocessingrefslot",level:3},{value:"Devuelve",id:"devuelve",level:4},{value:"getResumeSinceTimestamp()",id:"getresumesincetimestamp",level:3},{value:"isPaused()",id:"ispaused",level:3},{value:"M\xe9todos",id:"m\xe9todos",level:2},{value:"submitReportData()",id:"submitreportdata",level:3},{value:"Par\xe1metros",id:"par\xe1metros-1",level:4},{value:"Reversiones",id:"reversiones-1",level:4},{value:"pauseFor()",id:"pausefor",level:3},{value:"Par\xe1metros",id:"par\xe1metros-2",level:4},{value:"Reversiones",id:"reversiones-2",level:4},{value:"pauseUntil()",id:"pauseuntil",level:3},{value:"Par\xe1metros",id:"par\xe1metros-3",level:4},{value:"Reversiones",id:"reversiones-3",level:4},{value:"resume()",id:"resume",level:3},{value:"Reversiones",id:"reversiones-4",level:4},{value:"Permisos",id:"permisos",level:2},{value:"SUBMIT_DATA_ROLE()",id:"submit_data_role",level:3},{value:"PAUSE_ROLE()",id:"pause_role",level:3},{value:"RESUME_ROLE()",id:"resume_role",level:3},{value:"MANAGE_CONSENSUS_CONTRACT_ROLE()",id:"manage_consensus_contract_role",level:3},{value:"MANAGE_CONSENSUS_VERSION_ROLE()",id:"manage_consensus_version_role",level:3},{value:"Eventos",id:"eventos",level:2},{value:"ValidatorExitRequest()",id:"validatorexitrequest",level:3},{value:"WarnDataIncompleteProcessing()",id:"warndataincompleteprocessing",level:3},{value:"Paused()",id:"paused",level:3},{value:"Resumed()",id:"resumed",level:3}];function t(e){const s={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,d.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(s.h1,{id:"validatorsexitbusoracle",children:"ValidatorsExitBusOracle"}),"\n",(0,a.jsxs)(s.ul,{children:["\n",(0,a.jsx)(s.li,{children:(0,a.jsx)(s.a,{href:"https://github.com/lidofinance/lido-dao/blob/master/contracts/0.8.9/oracle/ValidatorsExitBusOracle.sol",children:"C\xf3digo fuente"})}),"\n",(0,a.jsx)(s.li,{children:(0,a.jsx)(s.a,{href:"https://etherscan.io/address/0x0De4Ea0184c2ad0BacA7183356Aea5B8d5Bf5c6e",children:"Contrato desplegado"})}),"\n",(0,a.jsxs)(s.li,{children:["Hereda de ",(0,a.jsx)(s.a,{href:"https://github.com/lidofinance/lido-dao/blob/master/contracts/0.8.9/oracle/BaseOracle.sol",children:"BaseOracle"})]}),"\n"]}),"\n",(0,a.jsx)(s.admonition,{type:"info",children:(0,a.jsxs)(s.p,{children:["Se recomienda leer ",(0,a.jsx)(s.a,{href:"/gu%C3%ADas/oracle-operator-manual#introducci%C3%B3n",children:"\xbfQu\xe9 es el mecanismo de or\xe1culo de Lido?"})," antes de continuar."]})}),"\n",(0,a.jsx)(s.h2,{id:"qu\xe9-es-validatorsexitbusoracle",children:"\xbfQu\xe9 es ValidatorsExitBusOracle?"}),"\n",(0,a.jsx)(s.p,{children:'Es un contrato que implementa un "bus de mensajes" en la cadena como fuente de verdad entre el or\xe1culo fuera de la cadena del protocolo y los observadores fuera de la cadena, con el objetivo principal de entregar solicitudes de salida de validadores a los operadores de nodos que participan en Lido.'}),"\n",(0,a.jsx)(s.p,{children:"El c\xe1lculo de un informe consta de 4 pasos clave:"}),"\n",(0,a.jsxs)(s.ol,{children:["\n",(0,a.jsx)(s.li,{children:"Calcular la cantidad de retiros a cubrir con ether."}),"\n",(0,a.jsx)(s.li,{children:"Calcular la predicci\xf3n de recompensas en ether por \xe9poca."}),"\n",(0,a.jsx)(s.li,{children:"Calcular la \xe9poca de retiro para el siguiente validador elegible para salir y cubrir las solicitudes de retiro si es necesario."}),"\n",(0,a.jsx)(s.li,{children:"Preparar la cola de \xf3rdenes de salida de validadores."}),"\n",(0,a.jsx)(s.li,{children:"Recorrer la cola hasta que los saldos de los validadores que han salido cubran todas las solicitudes de retiro (considerando el saldo final predicho de cada validador que ha salido)."}),"\n"]}),"\n",(0,a.jsx)(s.admonition,{type:"note",children:(0,a.jsxs)(s.p,{children:["Las solicitudes de salida realizadas a trav\xe9s de ",(0,a.jsx)(s.code,{children:"ValidatorsExitBusOracle"})," deben procesarse a tiempo seg\xfan la pol\xedtica ratificada ",(0,a.jsx)(s.a,{href:"https://snapshot.org/#/lido-snapshot.eth/proposal/0xa4eb1220a15d46a1825d5a0f44de1b34644d4aa6bb95f910b86b29bb7654e330",children:"Lido en Ethereum Pol\xedticas de Salidas de Validadores V1.0"}),"."]})}),"\n",(0,a.jsxs)(s.p,{children:["El acceso a los m\xe9todos de palanca est\xe1 restringido utilizando la funcionalidad del contrato ",(0,a.jsx)(s.a,{href:"https://github.com/lidofinance/lido-dao/blob/master/contracts/0.8.9/utils/access/AccessControlEnumerable.sol",children:"AccessControlEnumerable"})," y un conjunto de ",(0,a.jsx)(s.a,{href:"#permisos",children:"roles granulares"}),"."]}),"\n",(0,a.jsx)(s.h2,{id:"ciclo-del-informe",children:"Ciclo del informe"}),"\n",(0,a.jsx)(s.p,{children:"El trabajo del or\xe1culo se divide en per\xedodos de tiempo iguales llamados marcos. En operaci\xf3n normal, los or\xe1culos finalizan un informe en cada marco (la duraci\xf3n del marco es de 75 \xe9pocas de la Capa de Consenso de Ethereum, cada marco comienza aproximadamente a las 04:00, 12:00 y 20:00 UTC). Cada marco tiene una ranura de referencia y una fecha l\xedmite de procesamiento. Los datos del informe se recopilan observando el estado del mundo (tanto en las Capas de Ejecuci\xf3n y Consenso de Ethereum) en el momento de la ranura de referencia del marco (incluyendo cualquier cambio de estado realizado en esa ranura), y deben procesarse antes de la fecha l\xedmite de procesamiento del marco."}),"\n",(0,a.jsx)(s.p,{children:"La ranura de referencia para cada marco se establece en la \xfaltima ranura de la \xe9poca que precede a la primera \xe9poca del marco. La fecha l\xedmite de procesamiento se establece en la \xfaltima ranura de la \xfaltima \xe9poca del marco."}),"\n",(0,a.jsxs)(s.p,{children:["Vale la pena se\xf1alar que la duraci\xf3n del marco ",(0,a.jsx)(s.a,{href:"./hash-consensus#setframeconfig",children:"puede cambiar"}),". Y si el informe del or\xe1culo se retrasa, no extiende el per\xedodo del informe, a menos que se pierda. En este caso, el siguiente informe tendr\xe1 el per\xedodo del informe aumentado."]}),"\n",(0,a.jsx)(s.p,{children:"El marco incluye estas etapas:"}),"\n",(0,a.jsxs)(s.ul,{children:["\n",(0,a.jsxs)(s.li,{children:[(0,a.jsx)(s.strong,{children:"Esperando"}),": el or\xe1culo comienza como un ",(0,a.jsx)(s.a,{href:"/gu%C3%ADas/oracle-operator-manual#el-daemon-del-or%C3%A1culo",children:"daemon"})," y se despierta cada 12 segundos (por defecto) para encontrar la \xfaltima ranura finalizada, tratando de hacerla coincidir con la ranura de referencia esperada;"]}),"\n",(0,a.jsxs)(s.li,{children:[(0,a.jsx)(s.strong,{children:"Recolecci\xf3n de datos"}),": los or\xe1culos monitorean el estado de las capas de ejecuci\xf3n y consenso y recopilan los datos para la ranura de referencia finalizada que ha llegado con \xe9xito;"]}),"\n",(0,a.jsxs)(s.li,{children:[(0,a.jsx)(s.strong,{children:"Consenso de hash"}),": los or\xe1culos analizan los datos del informe, compilan el informe y env\xedan su hash al contrato inteligente ",(0,a.jsx)(s.a,{href:"/contracts/hash-consensus",children:"HashConsensus"}),";"]}),"\n",(0,a.jsxs)(s.li,{children:[(0,a.jsx)(s.strong,{children:"Informe de actualizaci\xf3n principal"}),": una vez que se alcanza el ",(0,a.jsx)(s.a,{href:"./hash-consensus#getquorum",children:"qu\xf3rum"})," de hashes, es decir, m\xe1s de la mitad de los or\xe1culos enviaron el mismo hash (es decir, 5 de 9 miembros del comit\xe9 de or\xe1culos en el momento de escribir esto), uno de los or\xe1culos elegidos por turno env\xeda el informe real al contrato ",(0,a.jsx)(s.code,{children:"ValidatorsExitBusOracle"}),", lo que desencadena una cadena de eventos ",(0,a.jsx)(s.a,{href:"#validatorexitrequest",children:(0,a.jsx)(s.code,{children:"ValidatorExitRequest"})})," que contienen detalles sobre los siguientes validadores a ser expulsados (para iniciar una salida voluntaria del lado de la Capa de Consenso de Ethereum)."]}),"\n"]}),"\n",(0,a.jsx)(s.h2,{id:"datos-del-informe",children:"Datos del informe"}),"\n",(0,a.jsxs)(s.p,{children:["La funci\xf3n ",(0,a.jsx)(s.code,{children:"submitReportData()"})," acepta la siguiente estructura ",(0,a.jsx)(s.code,{children:"ReportData"}),"."]}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-solidity",children:"struct ReportData {\n    uint256 consensusVersion;\n    uint256 refSlot;\n    uint256 requestsCount;\n    uint256 dataFormat;\n    bytes data;\n}\n"})}),"\n",(0,a.jsx)(s.p,{children:(0,a.jsx)(s.strong,{children:"Informaci\xf3n del consenso del or\xe1culo"})}),"\n",(0,a.jsxs)(s.ul,{children:["\n",(0,a.jsxs)(s.li,{children:[(0,a.jsx)(s.code,{children:"consensusVersion"}),": versi\xf3n de las reglas de consenso del or\xe1culo. Se puede obtener la versi\xf3n actual esperada por el or\xe1culo llamando a ",(0,a.jsx)(s.code,{children:"getConsensusVersion()"}),"."]}),"\n",(0,a.jsxs)(s.li,{children:[(0,a.jsx)(s.code,{children:"refSlot"}),": ranura de referencia para la cual se calcul\xf3 el informe. El estado informado debe incluir todos los cambios de estado resultantes de todos los bloques hasta esta ranura (inclusive). La \xe9poca que contiene la ranura debe estar finalizada antes de calcular el informe."]}),"\n"]}),"\n",(0,a.jsx)(s.p,{children:(0,a.jsx)(s.strong,{children:"Datos de solicitudes"})}),"\n",(0,a.jsxs)(s.ul,{children:["\n",(0,a.jsxs)(s.li,{children:[(0,a.jsx)(s.code,{children:"requestsCount"}),": n\xfamero total de solicitudes de salida de validadores en este informe. No debe ser mayor que el l\xedmite impuesto por ",(0,a.jsx)(s.code,{children:"OracleReportSanityChecker.checkExitBusOracleReport"}),"."]}),"\n",(0,a.jsxs)(s.li,{children:[(0,a.jsx)(s.code,{children:"dataFormat"}),": formato de los datos de solicitudes de salida de validadores. Actualmente, solo se admite el valor ",(0,a.jsx)(s.code,{children:"DATA_FORMAT_LIST=1"}),"."]}),"\n",(0,a.jsxs)(s.li,{children:[(0,a.jsx)(s.code,{children:"data"}),": datos de solicitudes de salida de validadores. Pueden diferir seg\xfan el formato de datos, consulte la constante que define un formato de datos espec\xedfico ",(0,a.jsx)(s.a,{href:"#data_format_list",children:"aqu\xed"})," para obtener m\xe1s informaci\xf3n."]}),"\n"]}),"\n",(0,a.jsx)(s.h2,{id:"constantes",children:"Constantes"}),"\n",(0,a.jsx)(s.h3,{id:"data_format_list",children:"DATA_FORMAT_LIST()"}),"\n",(0,a.jsx)(s.p,{children:"El formato de lista de los datos de solicitudes de salida de validadores."}),"\n",(0,a.jsxs)(s.admonition,{type:"note",children:[(0,a.jsx)(s.p,{children:"Cada solicitud de salida de validador se describe con el siguiente array de 64 bytes:"}),(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{children:"    MSB <------------------------------------------------------- LSB\n    |  3 bytes   |  5 bytes   |     8 bytes      |    48 bytes     |\n    |  moduleId  |  nodeOpId  |  validatorIndex  | validatorPubkey |\n"})}),(0,a.jsxs)(s.p,{children:["Todas las solicitudes est\xe1n empaquetadas estrechamente en un array de bytes donde las solicitudes siguen\nunas a otras sin ning\xfan separador o relleno, y se pasan al campo ",(0,a.jsx)(s.code,{children:"data"})," de la estructura del informe."]}),(0,a.jsxs)(s.p,{children:["Las solicitudes deben estar ordenadas en orden ascendente por la siguiente clave compuesta: ",(0,a.jsx)(s.code,{children:"(moduleId, nodeOpId, validatorIndex)"}),"."]})]}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-solidity",children:"uint256 public constant DATA_FORMAT_LIST = 1\n"})}),"\n",(0,a.jsx)(s.h3,{id:"seconds_per_slot",children:"SECONDS_PER_SLOT()"}),"\n",(0,a.jsxs)(s.p,{children:["Vea ",(0,a.jsx)(s.a,{href:"https://ethereum.org/en/developers/docs/blocks/#block-time",children:"https://ethereum.org/en/developers/docs/blocks/#block-time"})]}),"\n",(0,a.jsx)(s.admonition,{type:"note",children:(0,a.jsxs)(s.p,{children:["Siempre devuelve 12 segundos debido a ",(0,a.jsx)(s.a,{href:"https://ethereum.org/en/roadmap/merge/",children:"el Merge"})]})}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-solidity",children:"uint256 public immutable SECONDS_PER_SLOT\n"})}),"\n",(0,a.jsx)(s.h3,{id:"genesis_time",children:"GENESIS_TIME()"}),"\n",(0,a.jsxs)(s.p,{children:["Vea ",(0,a.jsx)(s.a,{href:"https://blog.ethereum.org/2020/11/27/eth2-quick-update-no-21",children:"https://blog.ethereum.org/2020/11/27/eth2-quick-update-no-21"})]}),"\n",(0,a.jsx)(s.admonition,{type:"note",children:(0,a.jsxs)(s.p,{children:["Siempre devuelve 1606824023 (1 de diciembre de 2020, 12:00:23pm UTC) en la ",(0,a.jsx)(s.a,{href:"https://blog.ethereum.org/2020/11/27/eth2-quick-update-no-21",children:"Mainnet"})]})}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-solidity",children:"uint256 public immutable GENESIS_TIME\n"})}),"\n",(0,a.jsx)(s.h3,{id:"pause_infinitely",children:"PAUSE_INFINITELY()"}),"\n",(0,a.jsxs)(s.p,{children:["Valor especial para la pausa infinita.\nVea ",(0,a.jsx)(s.a,{href:"#pausefor",children:(0,a.jsx)(s.code,{children:"pauseFor"})})," y ",(0,a.jsx)(s.a,{href:"#pauseuntil",children:(0,a.jsx)(s.code,{children:"pauseUntil"})}),"."]}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-solidity",children:"uint256 public constant PAUSE_INFINITELY = type(uint256).max\n"})}),"\n",(0,a.jsx)(s.h2,{id:"processingstate",children:"ProcessingState"}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-solidity",children:"struct ProcessingState {\n    uint256 currentFrameRefSlot;\n    uint256 processingDeadlineTime;\n    bytes32 dataHash;\n    bool dataSubmitted;\n    uint256 dataFormat;\n    uint256 requestsCount;\n    uint256 requestsSubmitted;\n}\n"})}),"\n",(0,a.jsxs)(s.ul,{children:["\n",(0,a.jsxs)(s.li,{children:[(0,a.jsx)(s.code,{children:"currentFrameRefSlot"})," \u2014 Ranura de referencia para el marco de informes actual."]}),"\n",(0,a.jsxs)(s.li,{children:[(0,a.jsx)(s.code,{children:"processingDeadlineTime"})," \u2014 El \xfaltimo momento en que se pueden enviar datos del informe para el marco de informes actual."]}),"\n",(0,a.jsxs)(s.li,{children:[(0,a.jsx)(s.code,{children:"dataHash"})," \u2014 Hash de los datos del informe. Bytes cero si no se ha alcanzado el consenso sobre el hash para el marco de informes actual."]}),"\n",(0,a.jsxs)(s.li,{children:[(0,a.jsx)(s.code,{children:"dataSubmitted"})," \u2014 Si ya se han enviado datos del informe para el marco de informes actual."]}),"\n",(0,a.jsxs)(s.li,{children:[(0,a.jsx)(s.code,{children:"dataFormat"})," \u2014 Formato de los datos del informe para el marco de informes actual."]}),"\n",(0,a.jsxs)(s.li,{children:[(0,a.jsx)(s.code,{children:"requestsCount"})," \u2014 N\xfamero total de solicitudes de salida de validadores para el marco de informes actual."]}),"\n",(0,a.jsxs)(s.li,{children:[(0,a.jsx)(s.code,{children:"requestsSubmitted"})," \u2014 Cu\xe1ntas solicitudes de salida de validadores ya se han enviado para el marco de informes actual."]}),"\n"]}),"\n",(0,a.jsx)(s.h2,{id:"m\xe9todos-de-vista",children:"M\xe9todos de vista"}),"\n",(0,a.jsx)(s.h3,{id:"gettotalrequestsprocessed",children:"getTotalRequestsProcessed()"}),"\n",(0,a.jsx)(s.p,{children:"Devuelve el n\xfamero total de solicitudes de salida de validadores procesadas en todos los informes recibidos."}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-solidity",children:"function getTotalRequestsProcessed() external view returns (uint256)\n"})}),"\n",(0,a.jsx)(s.h3,{id:"getlastrequestedvalidatorindices",children:"getLastRequestedValidatorIndices()"}),"\n",(0,a.jsxs)(s.p,{children:["Devuelve los \xfaltimos \xedndices de validadores que se solicitaron para salir para los\n",(0,a.jsx)(s.code,{children:"nodeOpIds"})," dados en el ",(0,a.jsx)(s.code,{children:"moduleId"})," dado. Para los operadores de nodos que nunca se solicitaron para salir\nning\xfan validador, el \xedndice se establece en ",(0,a.jsx)(s.code,{children:"-1"}),"."]}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-solidity",children:"function getLastRequestedValidatorIndices(uint256 moduleId, uint256[] calldata nodeOpIds)\n        external view returns (int256[] memory)\n"})}),"\n",(0,a.jsx)(s.h4,{id:"par\xe1metros",children:"Par\xe1metros"}),"\n",(0,a.jsxs)(s.table,{children:[(0,a.jsx)(s.thead,{children:(0,a.jsxs)(s.tr,{children:[(0,a.jsx)(s.th,{children:"Nombre"}),(0,a.jsx)(s.th,{children:"Tipo"}),(0,a.jsx)(s.th,{children:"Descripci\xf3n"})]})}),(0,a.jsxs)(s.tbody,{children:[(0,a.jsxs)(s.tr,{children:[(0,a.jsx)(s.td,{children:(0,a.jsx)(s.code,{children:"moduleId"})}),(0,a.jsx)(s.td,{children:(0,a.jsx)(s.code,{children:"uint256"})}),(0,a.jsx)(s.td,{children:"ID del m\xf3dulo de staking."})]}),(0,a.jsxs)(s.tr,{children:[(0,a.jsx)(s.td,{children:(0,a.jsx)(s.code,{children:"nodeOpIds"})}),(0,a.jsx)(s.td,{children:(0,a.jsx)(s.code,{children:"uint256"})}),(0,a.jsx)(s.td,{children:"IDs de los operadores de nodos del m\xf3dulo de staking."})]})]})]}),"\n",(0,a.jsx)(s.h4,{id:"reversiones",children:"Reversiones"}),"\n",(0,a.jsxs)(s.ul,{children:["\n",(0,a.jsxs)(s.li,{children:["Revierte con ",(0,a.jsx)(s.code,{children:"ArgumentOutOfBounds()"})," si ",(0,a.jsx)(s.code,{children:"moduleId > UINT24_MAX"})]}),"\n",(0,a.jsxs)(s.li,{children:["Revierte con ",(0,a.jsx)(s.code,{children:"ArgumentOutOfBounds()"})," si ",(0,a.jsx)(s.code,{children:"nodeOpId > UINT40_MAX"})]}),"\n"]}),"\n",(0,a.jsx)(s.h3,{id:"getprocessingstate",children:"getProcessingState()"}),"\n",(0,a.jsxs)(s.p,{children:["Devuelve el estado de procesamiento de datos para el marco de informes actual. Consulte la documentaci\xf3n de la estructura ",(0,a.jsx)(s.a,{href:"#processingstate",children:"ProcessingState"}),"."]}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-solidity",children:"function getProcessingState() external view returns (ProcessingState memory result)\n"})}),"\n",(0,a.jsx)(s.h3,{id:"getconsensuscontract",children:"getConsensusContract()"}),"\n",(0,a.jsxs)(s.p,{children:["Devuelve la direcci\xf3n de la instancia del contrato ",(0,a.jsx)(s.a,{href:"/contracts/hash-consensus",children:"HashConsensus"})," utilizada por ",(0,a.jsx)(s.code,{children:"ValidatorsExitBusOracle"}),"."]}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-solidity",children:"function getConsensusContract() external view returns (address)\n"})}),"\n",(0,a.jsx)(s.h3,{id:"getconsensusreport",children:"getConsensusReport()"}),"\n",(0,a.jsx)(s.p,{children:"Devuelve el \xfaltimo hash del informe de consenso y metadatos."}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-solidity",children:"function getConsensusReport() external view returns (\n    bytes32 hash,\n    uint256 refSlot,\n    uint256 processingDeadlineTime,\n    bool processingStarted\n)\n"})}),"\n",(0,a.jsx)(s.h3,{id:"getconsensusversion",children:"getConsensusVersion()"}),"\n",(0,a.jsx)(s.p,{children:"Devuelve la versi\xf3n actual del consenso esperada por el contrato del or\xe1culo."}),"\n",(0,a.jsx)(s.admonition,{type:"note",children:(0,a.jsx)(s.p,{children:"La versi\xf3n del consenso debe cambiar cada vez que cambian las reglas del consenso, lo que significa que\nun or\xe1culo que mire la misma ranura de referencia calcular\xeda un hash diferente."})}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-solidity",children:"function getConsensusVersion() external view returns (uint256)\n"})}),"\n",(0,a.jsx)(s.h3,{id:"getcontractversion",children:"getContractVersion()"}),"\n",(0,a.jsx)(s.p,{children:"Devuelve la versi\xf3n actual del contrato."}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-solidity",children:"function getContractVersion() public view returns (uint256)\n"})}),"\n",(0,a.jsx)(s.h3,{id:"getlastprocessingrefslot",children:"getLastProcessingRefSlot()"}),"\n",(0,a.jsx)(s.p,{children:"Devuelve la \xfaltima ranura de referencia para la cual se inici\xf3 el procesamiento del informe."}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-solidity",children:"function getLastProcessingRefSlot() external view returns (uint256)\n"})}),"\n",(0,a.jsx)(s.h4,{id:"devuelve",children:"Devuelve"}),"\n",(0,a.jsxs)(s.table,{children:[(0,a.jsx)(s.thead,{children:(0,a.jsxs)(s.tr,{children:[(0,a.jsx)(s.th,{children:"Nombre"}),(0,a.jsx)(s.th,{children:"Tipo"}),(0,a.jsx)(s.th,{children:"Descripci\xf3n"})]})}),(0,a.jsxs)(s.tbody,{children:[(0,a.jsxs)(s.tr,{children:[(0,a.jsx)(s.td,{children:(0,a.jsx)(s.code,{children:"hash"})}),(0,a.jsx)(s.td,{children:(0,a.jsx)(s.code,{children:"bytes32"})}),(0,a.jsx)(s.td,{children:"El \xfaltimo hash informado"})]}),(0,a.jsxs)(s.tr,{children:[(0,a.jsx)(s.td,{children:(0,a.jsx)(s.code,{children:"refSlot"})}),(0,a.jsx)(s.td,{children:(0,a.jsx)(s.code,{children:"uint256"})}),(0,a.jsx)(s.td,{children:"La ranura de referencia del marco: si los datos de los que se est\xe1 alcanzando el consenso incluyen o dependen de alg\xfan estado en la cadena, este estado debe consultarse en la ranura de referencia. Si la ranura contiene un bloque, el estado debe incluir todos los cambios de ese bloque."})]}),(0,a.jsxs)(s.tr,{children:[(0,a.jsx)(s.td,{children:(0,a.jsx)(s.code,{children:"processingDeadlineTime"})}),(0,a.jsx)(s.td,{children:(0,a.jsx)(s.code,{children:"uint256"})}),(0,a.jsx)(s.td,{children:"La marca de tiempo de la \xfaltima ranura en la que se puede informar y procesar un informe"})]}),(0,a.jsxs)(s.tr,{children:[(0,a.jsx)(s.td,{children:(0,a.jsx)(s.code,{children:"processingStarted"})}),(0,a.jsx)(s.td,{children:(0,a.jsx)(s.code,{children:"bool"})}),(0,a.jsx)(s.td,{children:"Si se ha iniciado o no el procesamiento del informe"})]})]})]}),"\n",(0,a.jsx)(s.h3,{id:"getresumesincetimestamp",children:"getResumeSinceTimestamp()"}),"\n",(0,a.jsxs)(s.p,{children:["Devuelve uno de los valores ",(0,a.jsx)(s.code,{children:"timestamp"}),":"]}),"\n",(0,a.jsxs)(s.ul,{children:["\n",(0,a.jsxs)(s.li,{children:[(0,a.jsx)(s.code,{children:"PAUSE_INFINITELY"})," si est\xe1 pausado permanentemente (es decir, sin marca de tiempo de expiraci\xf3n)"]}),"\n",(0,a.jsxs)(s.li,{children:["el primer segundo cuando el contrato se reanuda si est\xe1 pausado por una duraci\xf3n espec\xedfica (si ",(0,a.jsx)(s.code,{children:"timestamp \u2265 block.timestamp"}),")"]}),"\n",(0,a.jsxs)(s.li,{children:["alguna marca de tiempo en el pasado si no est\xe1 pausado (si ",(0,a.jsx)(s.code,{children:"timestamp < block.timestamp"}),")"]}),"\n"]}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-solidity",children:"function getResumeSinceTimestamp() external view returns (uint256 timestamp)\n"})}),"\n",(0,a.jsx)(s.h3,{id:"ispaused",children:"isPaused()"}),"\n",(0,a.jsx)(s.p,{children:"Devuelve si el contrato est\xe1 pausado o no en este momento."}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-solidity",children:"function isPaused() public view returns (bool)\n"})}),"\n",(0,a.jsx)(s.h2,{id:"m\xe9todos",children:"M\xe9todos"}),"\n",(0,a.jsx)(s.h3,{id:"submitreportdata",children:"submitReportData()"}),"\n",(0,a.jsx)(s.p,{children:"Env\xeda datos del informe para su procesamiento."}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-solidity",children:"function submitReportData(ReportData calldata data, uint256 contractVersion)\n        external whenResumed\n"})}),"\n",(0,a.jsx)(s.h4,{id:"par\xe1metros-1",children:"Par\xe1metros"}),"\n",(0,a.jsxs)(s.table,{children:[(0,a.jsx)(s.thead,{children:(0,a.jsxs)(s.tr,{children:[(0,a.jsx)(s.th,{children:"Nombre"}),(0,a.jsx)(s.th,{children:"Tipo"}),(0,a.jsx)(s.th,{children:"Descripci\xf3n"})]})}),(0,a.jsxs)(s.tbody,{children:[(0,a.jsxs)(s.tr,{children:[(0,a.jsx)(s.td,{children:(0,a.jsx)(s.code,{children:"data"})}),(0,a.jsx)(s.td,{children:(0,a.jsx)(s.code,{children:"ReportData"})}),(0,a.jsxs)(s.td,{children:["Los datos del informe. Consulte ",(0,a.jsx)(s.a,{href:"#datos-del-informe",children:(0,a.jsx)(s.code,{children:"ReportData"})})," para m\xe1s detalles."]})]}),(0,a.jsxs)(s.tr,{children:[(0,a.jsx)(s.td,{children:(0,a.jsx)(s.code,{children:"contractVersion"})}),(0,a.jsx)(s.td,{children:(0,a.jsx)(s.code,{children:"uint256"})}),(0,a.jsx)(s.td,{children:"Versi\xf3n esperada del contrato del or\xe1culo."})]})]})]}),"\n",(0,a.jsx)(s.h4,{id:"reversiones-1",children:"Reversiones"}),"\n",(0,a.jsxs)(s.ul,{children:["\n",(0,a.jsxs)(s.li,{children:["Revierte con ",(0,a.jsx)(s.code,{children:"SenderNotAllowed()"})," si el remitente no tiene el rol ",(0,a.jsx)(s.code,{children:"SUBMIT_DATA_ROLE"})," y no es un miembro del comit\xe9 de or\xe1culos."]}),"\n",(0,a.jsxs)(s.li,{children:["Revierte con ",(0,a.jsx)(s.code,{children:"UnexpectedContractVersion(expectedVersion, version)"})," si la versi\xf3n del contrato proporcionada difiere de la actual."]}),"\n",(0,a.jsxs)(s.li,{children:["Revierte con ",(0,a.jsx)(s.code,{children:"UnexpectedConsensusVersion(expectedConsensusVersion, consensusVersion)"})," si la versi\xf3n de consenso proporcionada difiere de la esperada."]}),"\n",(0,a.jsxs)(s.li,{children:["Revierte con ",(0,a.jsx)(s.code,{children:"UnexpectedRefSlot(report.refSlot, refSlot)"})," si la ranura de referencia proporcionada difiere de la del marco de consenso actual."]}),"\n",(0,a.jsxs)(s.li,{children:["Revierte con ",(0,a.jsx)(s.code,{children:"UnexpectedDataHash(report.hash, hash)"})," si un hash ",(0,a.jsx)(s.code,{children:"keccak256"})," de los datos codificados en ABI difiere del \xfaltimo hash."]}),"\n",(0,a.jsxs)(s.li,{children:["Revierte con ",(0,a.jsx)(s.code,{children:"NoConsensusReportToProcess()"})," si el hash de datos del informe es ",(0,a.jsx)(s.code,{children:"0"}),"."]}),"\n",(0,a.jsxs)(s.li,{children:["Revierte con ",(0,a.jsx)(s.code,{children:"RefSlotAlreadyProcessing()"})," si la ranura de referencia del informe es igual a la ranura de referencia de procesamiento anterior."]}),"\n",(0,a.jsxs)(s.li,{children:["Revierte con ",(0,a.jsx)(s.code,{children:"InvalidRequestsData()"})," si ",(0,a.jsx)(s.code,{children:"moduleId"})," en los datos proporcionados es ",(0,a.jsx)(s.code,{children:"0"})]}),"\n",(0,a.jsxs)(s.li,{children:["Revierte con ",(0,a.jsx)(s.code,{children:"InvalidRequestsDataLength()"})," si los datos proporcionados est\xe1n empaquetados incorrectamente"]}),"\n",(0,a.jsxs)(s.li,{children:["Revierte con ",(0,a.jsx)(s.code,{children:"UnexpectedRequestsDataLength()"})," si la longitud de los datos empaquetados proporcionados no es igual a ",(0,a.jsx)(s.code,{children:"data.requestsCount"})]}),"\n",(0,a.jsxs)(s.li,{children:["Revierte con ",(0,a.jsx)(s.code,{children:"InvalidRequestsDataSortOrder"})," cuando los datos proporcionados no est\xe1n ordenados"]}),"\n",(0,a.jsxs)(s.li,{children:["Revierte con ",(0,a.jsx)(s.code,{children:"NodeOpValidatorIndexMustIncrease(       uint256 moduleId,       uint256 nodeOpId,       uint256 prevRequestedValidatorIndex,       uint256 requestedValidatorIndex   )"})," si ",(0,a.jsx)(s.code,{children:"requested validator index <= last requested index"})," del mismo m\xf3dulo"]}),"\n"]}),"\n",(0,a.jsx)(s.h3,{id:"pausefor",children:"pauseFor()"}),"\n",(0,a.jsx)(s.p,{children:"Pausa la aceptaci\xf3n de los datos de los informes y la formaci\xf3n de nuevas solicitudes de salida de validadores por la duraci\xf3n proporcionada en segundos."}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-solidity",children:"function pauseFor(uint256 _duration) external\n"})}),"\n",(0,a.jsx)(s.h4,{id:"par\xe1metros-2",children:"Par\xe1metros"}),"\n",(0,a.jsxs)(s.table,{children:[(0,a.jsx)(s.thead,{children:(0,a.jsxs)(s.tr,{children:[(0,a.jsx)(s.th,{children:"Nombre"}),(0,a.jsx)(s.th,{children:"Tipo"}),(0,a.jsx)(s.th,{children:"Descripci\xf3n"})]})}),(0,a.jsx)(s.tbody,{children:(0,a.jsxs)(s.tr,{children:[(0,a.jsx)(s.td,{children:(0,a.jsx)(s.code,{children:"_duration"})}),(0,a.jsx)(s.td,{children:(0,a.jsx)(s.code,{children:"uint256"})}),(0,a.jsxs)(s.td,{children:["duraci\xf3n de la pausa, en segundos (usar ",(0,a.jsx)(s.code,{children:"PAUSE_INFINITELY"})," para ilimitado)"]})]})})]}),"\n",(0,a.jsx)(s.h4,{id:"reversiones-2",children:"Reversiones"}),"\n",(0,a.jsxs)(s.ul,{children:["\n",(0,a.jsxs)(s.li,{children:["Revierte con ",(0,a.jsx)(s.code,{children:"ResumedExpected()"})," si el contrato ya est\xe1 pausado"]}),"\n",(0,a.jsxs)(s.li,{children:["Revierte con ",(0,a.jsx)(s.code,{children:"AccessControl:..."})," raz\xf3n si el remitente no tiene el rol ",(0,a.jsx)(s.code,{children:"PAUSE_ROLE"})]}),"\n",(0,a.jsxs)(s.li,{children:["Revierte con ",(0,a.jsx)(s.code,{children:"ZeroPauseDuration()"})," si se pasa una duraci\xf3n cero"]}),"\n"]}),"\n",(0,a.jsx)(s.h3,{id:"pauseuntil",children:"pauseUntil()"}),"\n",(0,a.jsx)(s.p,{children:"Pausa la aceptaci\xf3n de los datos de los informes y la formaci\xf3n de nuevas solicitudes de salida de validadores hasta la marca de tiempo dada (inclusive)."}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-solidity",children:"function pauseUntil(uint256 _pauseUntilInclusive) external\n"})}),"\n",(0,a.jsx)(s.h4,{id:"par\xe1metros-3",children:"Par\xe1metros"}),"\n",(0,a.jsxs)(s.table,{children:[(0,a.jsx)(s.thead,{children:(0,a.jsxs)(s.tr,{children:[(0,a.jsx)(s.th,{children:"Nombre"}),(0,a.jsx)(s.th,{children:"Tipo"}),(0,a.jsx)(s.th,{children:"Descripci\xf3n"})]})}),(0,a.jsx)(s.tbody,{children:(0,a.jsxs)(s.tr,{children:[(0,a.jsx)(s.td,{children:(0,a.jsx)(s.code,{children:"_pauseUntilInclusive"})}),(0,a.jsx)(s.td,{children:(0,a.jsx)(s.code,{children:"uint256"})}),(0,a.jsx)(s.td,{children:"el \xfaltimo segundo para pausar (inclusive)"})]})})]}),"\n",(0,a.jsx)(s.h4,{id:"reversiones-3",children:"Reversiones"}),"\n",(0,a.jsxs)(s.ul,{children:["\n",(0,a.jsxs)(s.li,{children:["Revierte con ",(0,a.jsx)(s.code,{children:"ResumeSinceInPast()"})," si la marca de tiempo proporcionada est\xe1 en el pasado"]}),"\n",(0,a.jsxs)(s.li,{children:["Revierte con ",(0,a.jsx)(s.code,{children:"AccessControl:..."})," raz\xf3n si el remitente no tiene el rol ",(0,a.jsx)(s.code,{children:"PAUSE_ROLE"})]}),"\n",(0,a.jsxs)(s.li,{children:["Revierte con ",(0,a.jsx)(s.code,{children:"ResumedExpected()"})," si el contrato ya est\xe1 pausado"]}),"\n"]}),"\n",(0,a.jsx)(s.h3,{id:"resume",children:"resume()"}),"\n",(0,a.jsx)(s.p,{children:"Reanuda la aceptaci\xf3n de los datos de los informes y la formaci\xf3n de nuevas solicitudes de salida de validadores."}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-solidity",children:"function resume() external\n"})}),"\n",(0,a.jsx)(s.h4,{id:"reversiones-4",children:"Reversiones"}),"\n",(0,a.jsxs)(s.ul,{children:["\n",(0,a.jsxs)(s.li,{children:["Revierte con ",(0,a.jsx)(s.code,{children:"PausedExpected()"})," si el contrato ya est\xe1 reanudado (es decir, no pausado)"]}),"\n",(0,a.jsxs)(s.li,{children:["Revierte con ",(0,a.jsx)(s.code,{children:"AccessControl:..."})," raz\xf3n si el remitente no tiene el rol ",(0,a.jsx)(s.code,{children:"RESUME_ROLE"})]}),"\n"]}),"\n",(0,a.jsx)(s.h2,{id:"permisos",children:"Permisos"}),"\n",(0,a.jsx)(s.h3,{id:"submit_data_role",children:"SUBMIT_DATA_ROLE()"}),"\n",(0,a.jsx)(s.p,{children:"Un rol de ACL que otorga el permiso para enviar los datos para un informe del comit\xe9."}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-solidity",children:'bytes32 public constant SUBMIT_DATA_ROLE = keccak256("SUBMIT_DATA_ROLE")\n'})}),"\n",(0,a.jsx)(s.h3,{id:"pause_role",children:"PAUSE_ROLE()"}),"\n",(0,a.jsx)(s.p,{children:"Un rol de ACL que otorga el permiso para pausar la aceptaci\xf3n de los datos de los informes y la formaci\xf3n de nuevas solicitudes de salida de validadores."}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-solidity",children:'bytes32 public constant PAUSE_ROLE = keccak256("PAUSE_ROLE")\n'})}),"\n",(0,a.jsx)(s.h3,{id:"resume_role",children:"RESUME_ROLE()"}),"\n",(0,a.jsx)(s.p,{children:"Un rol de ACL que otorga el permiso para reanudar la aceptaci\xf3n de los datos de los informes y la formaci\xf3n de nuevas solicitudes de salida de validadores."}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-solidity",children:'bytes32 public constant RESUME_ROLE = keccak256("RESUME_ROLE")\n'})}),"\n",(0,a.jsx)(s.h3,{id:"manage_consensus_contract_role",children:"MANAGE_CONSENSUS_CONTRACT_ROLE()"}),"\n",(0,a.jsxs)(s.p,{children:["Un rol de ACL que otorga el permiso para establecer la direcci\xf3n del contrato de consenso llamando a ",(0,a.jsx)(s.code,{children:"setConsensusContract"}),"."]}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-solidity",children:'bytes32 public constant MANAGE_CONSENSUS_CONTRACT_ROLE = keccak256("MANAGE_CONSENSUS_CONTRACT_ROLE");\n'})}),"\n",(0,a.jsx)(s.h3,{id:"manage_consensus_version_role",children:"MANAGE_CONSENSUS_VERSION_ROLE()"}),"\n",(0,a.jsxs)(s.p,{children:["Un rol de ACL que otorga el permiso para establecer la versi\xf3n del consenso llamando a ",(0,a.jsx)(s.code,{children:"setConsensusVersion"}),"."]}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-solidity",children:'bytes32 public constant MANAGE_CONSENSUS_VERSION_ROLE = keccak256("MANAGE_CONSENSUS_VERSION_ROLE");\n'})}),"\n",(0,a.jsx)(s.h2,{id:"eventos",children:"Eventos"}),"\n",(0,a.jsx)(s.h3,{id:"validatorexitrequest",children:"ValidatorExitRequest()"}),"\n",(0,a.jsx)(s.p,{children:"Se emite cuando se env\xedan nuevos datos del informe para su procesamiento."}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-solidity",children:"event ValidatorExitRequest(\n    uint256 indexed stakingModuleId,\n    uint256 indexed nodeOperatorId,\n    uint256 indexed validatorIndex,\n    bytes validatorPubkey,\n    uint256 timestamp\n)\n"})}),"\n",(0,a.jsx)(s.h3,{id:"warndataincompleteprocessing",children:"WarnDataIncompleteProcessing()"}),"\n",(0,a.jsx)(s.p,{children:"Se emite al intentar enviar nuevos datos cuando no se han procesado todos los elementos."}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-solidity",children:"event WarnDataIncompleteProcessing(\n    uint256 indexed refSlot,\n    uint256 requestsProcessed,\n    uint256 requestsCount\n)\n"})}),"\n",(0,a.jsx)(s.h3,{id:"paused",children:"Paused()"}),"\n",(0,a.jsxs)(s.p,{children:["Se emite cuando el contrato se pausa, ya sea mediante las llamadas a ",(0,a.jsx)(s.code,{children:"pauseFor"})," o ",(0,a.jsx)(s.code,{children:"pauseUntil"}),"."]}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-solidity",children:"event Paused(uint256 duration)\n"})}),"\n",(0,a.jsx)(s.h3,{id:"resumed",children:"Resumed()"}),"\n",(0,a.jsxs)(s.p,{children:["Se emite cuando el contrato se reanuda mediante la llamada a ",(0,a.jsx)(s.code,{children:"resume"}),"."]}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-solidity",children:"event Resumed()\n"})})]})}function u(e={}){const{wrapper:s}={...(0,d.R)(),...e.components};return s?(0,a.jsx)(s,{...e,children:(0,a.jsx)(t,{...e})}):t(e)}},8453:(e,s,n)=>{n.d(s,{R:()=>r,x:()=>l});var a=n(6540);const d={},i=a.createContext(d);function r(e){const s=a.useContext(i);return a.useMemo((function(){return"function"==typeof e?e(s):{...s,...e}}),[s,e])}function l(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(d):e.components||d:r(e.components),a.createElement(i.Provider,{value:s},e.children)}}}]);