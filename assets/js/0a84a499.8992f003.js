"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[3167],{7557:(e,a,d)=>{d.r(a),d.d(a,{assets:()=>l,contentTitle:()=>i,default:()=>p,frontMatter:()=>n,metadata:()=>r,toc:()=>t});var o=d(4848),s=d(8453);const n={},i="Unirse a CSM",r={id:"staking-modules/csm/join-csm",title:"Unirse a CSM",description:"join-csm-1",source:"@site/docs/staking-modules/csm/join-csm.md",sourceDirName:"staking-modules/csm",slug:"/staking-modules/csm/join-csm",permalink:"/staking-modules/csm/join-csm",draft:!1,unlisted:!1,editUrl:"https://github.com/adminseedlatam/lido-docs-spanish/edit/main/docs/staking-modules/csm/join-csm.md",tags:[],version:"current",frontMatter:{},sidebar:"docs",previous:{title:"Introducci\xf3n",permalink:"/staking-modules/csm/intro"},next:{title:"Rewards",permalink:"/staking-modules/csm/rewards"}},l={},t=[{value:"Creaci\xf3n de Operador de Nodo",id:"creaci\xf3n-de-operador-de-nodo",level:2},{value:"Preparaci\xf3n y carga de datos de dep\xf3sito",id:"preparaci\xf3n-y-carga-de-datos-de-dep\xf3sito",level:2},{value:"Colateral",id:"colateral",level:2},{value:"Validadores no garantizados",id:"validadores-no-garantizados",level:3},{value:"Posibles consecuencias negativas del rebase de stETH",id:"posibles-consecuencias-negativas-del-rebase-de-steth",level:3},{value:"Validaci\xf3n y anulaci\xf3n de datos de dep\xf3sito (aka aprobaci\xf3n y desaprobaci\xf3n)",id:"validaci\xf3n-y-anulaci\xf3n-de-datos-de-dep\xf3sito-aka-aprobaci\xf3n-y-desaprobaci\xf3n",level:2},{value:"Claves depositables",id:"claves-depositables",level:2},{value:"Cola de asignaci\xf3n de Stake",id:"cola-de-asignaci\xf3n-de-stake",level:2},{value:"Eliminaci\xf3n de datos de dep\xf3sito",id:"eliminaci\xf3n-de-datos-de-dep\xf3sito",level:2},{value:"Per\xedodo de Adopci\xf3n Temprana",id:"per\xedodo-de-adopci\xf3n-temprana",level:2},{value:"Lecturas adicionales",id:"lecturas-adicionales",level:2}];function c(e){const a={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",img:"img",li:"li",p:"p",strong:"strong",ul:"ul",...(0,s.R)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(a.h1,{id:"unirse-a-csm",children:"Unirse a CSM"}),"\n",(0,o.jsx)(a.p,{children:(0,o.jsx)(a.img,{alt:"join-csm-1",src:d(2973).A+"",width:"2753",height:"1979"})}),"\n",(0,o.jsx)(a.h2,{id:"creaci\xf3n-de-operador-de-nodo",children:"Creaci\xf3n de Operador de Nodo"}),"\n",(0,o.jsxs)(a.p,{children:["Para convertirse en Operador de Nodo en CSM o registrar nuevos validadores para un Operador de Nodo existente, se debe proporcionar al menos una ",(0,o.jsx)(a.code,{children:"clave p\xfablica del validador"}),", la firma de dep\xf3sito correspondiente ",(0,o.jsx)(a.a,{href:"https://github.com/ethereum/consensus-specs/blob/v1.4.0/specs/phase0/beacon-chain.md#signingdata",children:(0,o.jsx)(a.code,{children:"signature"})}),", y el monto de colateral correspondiente."]}),"\n",(0,o.jsx)(a.h2,{id:"preparaci\xf3n-y-carga-de-datos-de-dep\xf3sito",children:"Preparaci\xf3n y carga de datos de dep\xf3sito"}),"\n",(0,o.jsxs)(a.p,{children:["CSM acepta datos de dep\xf3sito en el mismo ",(0,o.jsx)(a.a,{href:"../../contracts/node-operators-registry#addsigningkeys",children:"formato"})," (",(0,o.jsx)(a.code,{children:"clave p\xfablica del validador"})," + ",(0,o.jsx)(a.code,{children:"firma de dep\xf3sito"}),") que el ",(0,o.jsx)(a.a,{href:"/contracts/node-operators-registry",children:"m\xf3dulo Curated"}),", con la principal diferencia de que se requiere presentar el colateral antes o junto con la carga de datos de dep\xf3sito."]}),"\n",(0,o.jsxs)(a.p,{children:[(0,o.jsx)(a.a,{href:"https://github.com/ethereum/consensus-specs/blob/v1.4.0/specs/phase0/beacon-chain.md#signingdata",children:(0,o.jsx)(a.code,{children:"signature"})})," ",(0,o.jsx)(a.strong,{children:"debe"})," firmar la ra\xedz del ",(0,o.jsx)(a.code,{children:"(mensaje de dep\xf3sito, dominio)"}),". Donde ",(0,o.jsx)(a.code,{children:"dominio"})," se utiliza para identificar la cadena, y ",(0,o.jsx)(a.code,{children:"mensaje de dep\xf3sito"})," tiene la forma de la siguiente tupla:"]}),"\n",(0,o.jsxs)(a.ul,{children:["\n",(0,o.jsxs)(a.li,{children:[(0,o.jsx)(a.code,{children:"clave p\xfablica del validador"}),";"]}),"\n",(0,o.jsxs)(a.li,{children:[(0,o.jsx)(a.code,{children:"credenciales de retiro"})," con la direcci\xf3n real del ",(0,o.jsx)(a.a,{href:"../../contracts/withdrawal-vault",children:(0,o.jsx)(a.code,{children:"Contrato de B\xf3veda de Retiro de Lido"})}),". Debe recuperarse del ",(0,o.jsx)(a.a,{href:"/contracts/staking-router#getwithdrawalcredentials",children:"Enrutador de Staking"}),";"]}),"\n",(0,o.jsxs)(a.li,{children:[(0,o.jsx)(a.code,{children:"cantidad de 32 ETH"}),";"]}),"\n"]}),"\n",(0,o.jsx)(a.h2,{id:"colateral",children:"Colateral"}),"\n",(0,o.jsxs)(a.admonition,{type:"info",children:[(0,o.jsx)(a.p,{children:"Aqu\xed y despu\xe9s, el t\xe9rmino 'colateral' tiene el siguiente significado:"}),(0,o.jsxs)(a.p,{children:[(0,o.jsx)(a.strong,{children:"Colateral"})," - una garant\xeda de seguridad que los Operadores de Nodo deben presentar antes de cargar las claves de validador en CSM. Esta garant\xeda cubre posibles p\xe9rdidas causadas por acciones inapropiadas del lado del Operador de Nodo. Una vez que el validador sale de la cadena Beacon y todas las p\xe9rdidas que ocurrieron est\xe1n cubiertas, la garant\xeda se puede reclamar o reutilizar para cargar nuevas claves de validador."]})]}),"\n",(0,o.jsx)(a.p,{children:"El colateral es una propiedad de un Operador de Nodo, no de un validador. El colateral se almacena en forma de stETH. Los Operadores de Nodo pueden presentar tokens de colateral en ETH, stETH y wstETH. Si se proporciona ETH, se apuesta, y se desempaqueta wstETH durante la presentaci\xf3n para garantizar que stETH sea la \xfanica forma de colateral."}),"\n",(0,o.jsxs)(a.p,{children:["El monto total del colateral requerido depende del n\xfamero total de validadores del Operador de Nodo y tiene la forma de una curva (ver ",(0,o.jsx)(a.a,{href:"https://github.com/lidofinance/community-staking-module/blob/main/src/abstract/CSBondCurve.sol#L92",children:(0,o.jsx)(a.code,{children:"getBondAmountByKeysCount(keysCount)"})}),")"]}),"\n",(0,o.jsx)(a.p,{children:(0,o.jsx)(a.img,{alt:"join-csm-2",src:d(1766).A+"",width:"2226",height:"1314"})}),"\n",(0,o.jsx)(a.p,{children:"El gr\xe1fico anterior se puede volver a dibujar para la conveniencia del lector con respecto al n\xfamero de validadores, no a los validadores totales."}),"\n",(0,o.jsx)(a.p,{children:(0,o.jsx)(a.img,{alt:"join-csm-3",src:d(783).A+"",width:"2170",height:"996"})}),"\n",(0,o.jsxs)(a.p,{children:["Puede haber varias curvas de colateral (implementaciones de la funci\xf3n ",(0,o.jsx)(a.code,{children:"getBondAmountByKeysCount"}),"). Se asigna una curva predeterminada a todos los Operadores de Nodo al crearlos. M\xe1s tarde, se puede establecer una curva personalizada para el Operador de Nodo."]}),"\n",(0,o.jsx)(a.p,{children:"Los Operadores de Nodo existentes pueden aumentar el colateral sin cargar datos de dep\xf3sito para compensar las penalizaciones o para tener fondos de colateral cargados por adelantado."}),"\n",(0,o.jsx)(a.h3,{id:"validadores-no-garantizados",children:"Validadores no garantizados"}),"\n",(0,o.jsx)(a.p,{children:'El t\xe9rmino "no garantizado" se introduce para referirse a los validadores para los cuales el colateral no cubre completamente a este validador. Teniendo en cuenta el enfoque cuando el colateral es com\xfan para todos los validadores del Operador de Nodo, los validadores no garantizados se pueden determinar de la manera ilustrada a continuaci\xf3n. En el ejemplo, el validador N+1 no est\xe1 garantizado.'}),"\n",(0,o.jsx)(a.p,{children:(0,o.jsx)(a.img,{alt:"join-csm-4",src:d(4912).A+"",width:"2716",height:"528"})}),"\n",(0,o.jsx)(a.h3,{id:"posibles-consecuencias-negativas-del-rebase-de-steth",children:"Posibles consecuencias negativas del rebase de stETH"}),"\n",(0,o.jsxs)(a.p,{children:["Con el colateral almacenado en stETH, existe el riesgo de una reducci\xf3n en el monto del colateral debido a un rebase negativo de stETH. Esto podr\xeda resultar en que algunos Operadores de Nodo no puedan reclamar recompensas (debido a que el colateral real es menor de lo requerido) o incluso en que los validadores se vuelvan no garantizados. Este problema se describe en detalle en ",(0,o.jsx)(a.a,{href:"https://hackmd.io/@lido/BJqWx7P0p",children:"Mec\xe1nica del Bono en Lido ADR"}),". Para este documento, vale la pena mencionar que CSM no requiere acciones adicionales debido a la baja probabilidad de rebase negativo de stETH y a un ",(0,o.jsx)(a.a,{href:"/contracts/insurance",children:"fondo de seguro"})," dedicado a disposici\xf3n de Lido DAO para su posible uso como cobertura."]}),"\n",(0,o.jsx)(a.h2,{id:"validaci\xf3n-y-anulaci\xf3n-de-datos-de-dep\xf3sito-aka-aprobaci\xf3n-y-desaprobaci\xf3n",children:"Validaci\xf3n y anulaci\xf3n de datos de dep\xf3sito (aka aprobaci\xf3n y desaprobaci\xf3n)"}),"\n",(0,o.jsxs)(a.p,{children:["Dado el pr\xf3ximo ",(0,o.jsx)(a.a,{href:"https://hackmd.io/@lido/rJrTnEc2a",children:"DSM"})," mejora, CSM utilizar\xe1 un enfoque ",(0,o.jsx)(a.a,{href:"https://hackmd.io/@lido/ryw2Qo5ia",children:"optimista de aprobaci\xf3n"}),". Los datos de dep\xf3sito cargados se tratar\xe1n como v\xe1lidos a menos que DSM informe lo contrario. En caso de detecci\xf3n de datos de dep\xf3sito inv\xe1lidos, DSM llama a ",(0,o.jsx)(a.a,{href:"https://github.com/lidofinance/community-staking-module/blob/main/src/CSModule.sol#L861",children:(0,o.jsx)(a.code,{children:"decreaseVettedSigningKeysCount"})})," para establecer el puntero ",(0,o.jsx)(a.code,{children:"vettedKeys"})," a los datos de dep\xf3sito antes del primer dato de dep\xf3sito inv\xe1lido. En este caso, un Operador de Nodo debe eliminar las claves inv\xe1lidas para reanudar la asignaci\xf3n de participaci\xf3n a las claves v\xe1lidas no depositadas."]}),"\n",(0,o.jsx)(a.h2,{id:"claves-depositables",children:"Claves depositables"}),"\n",(0,o.jsxs)(a.p,{children:["Varios factores determinan si el dep\xf3sito se puede realizar utilizando los datos de dep\xf3sito correspondientes. Esta informaci\xf3n se refleja en la propiedad ",(0,o.jsx)(a.code,{children:"depositableKeys"})," del Operador de Nodo. Esta propiedad indica el n\xfamero de registros de datos de dep\xf3sito extra\xeddos secuencialmente a partir del \xfaltimo registro de dep\xf3sito disponible en el almacenamiento de claves del Operador de Nodo para dep\xf3sitos por el enrutador de staking. Este n\xfamero se determina de la siguiente manera:"]}),"\n",(0,o.jsxs)(a.ul,{children:["\n",(0,o.jsxs)(a.li,{children:[(0,o.jsx)(a.code,{children:"targetLimit"})," no est\xe1 establecido -> ",(0,o.jsx)(a.code,{children:"vettedKeys - depositedKeys - unbondedKeys"})]}),"\n",(0,o.jsxs)(a.li,{children:[(0,o.jsx)(a.code,{children:"targetLimit"})," est\xe1 establecido -> ",(0,o.jsx)(a.code,{children:"m\xednimo(vettedKeys, targetLimit) - depositedKeys - unbondedKeys"})]}),"\n",(0,o.jsxs)(a.li,{children:["Operador de Nodo tiene ",(0,o.jsx)(a.code,{children:"stuckKeys != 0"})," sin importar el ",(0,o.jsx)(a.code,{children:"targetLimit"})," -> ",(0,o.jsx)(a.code,{children:"0"}),"."]}),"\n"]}),"\n",(0,o.jsx)(a.h2,{id:"cola-de-asignaci\xf3n-de-stake",children:"Cola de asignaci\xf3n de Stake"}),"\n",(0,o.jsxs)(a.p,{children:["La cola de asignaci\xf3n de stake en CSM es una cola ",(0,o.jsx)(a.a,{href:"https://en.wikipedia.org/wiki/FIFO_(computing_and_electronics)",children:"FIFO"})," (primero en entrar, primero en salir) tradicional. Los Operadores de Nodo ocupan lugares en la cola con los lotes ",(0,o.jsx)(a.code,{children:"{noId, keysCount}"})," y esperan su turno."]}),"\n",(0,o.jsx)(a.p,{children:(0,o.jsx)(a.img,{alt:"join-csm-5",src:d(1161).A+"",width:"2616",height:"1385"})}),"\n",(0,o.jsxs)(a.p,{children:["Una vez que la cola alcanza el lote del Operador de Nodo, CSM verifica cu\xe1ntas claves del lote se pueden depositar utilizando la f\xf3rmula: ",(0,o.jsx)(a.code,{children:"m\xedn(depositableKeys, keysInBatch)"}),"."]}),"\n",(0,o.jsx)(a.p,{children:(0,o.jsx)(a.img,{alt:"join-csm-6",src:d(5074).A+"",width:"2058",height:"1025"})}),"\n",(0,o.jsxs)(a.p,{children:["Puede darse el caso de que un Operador de Nodo tenga claves que no est\xe1n en la cola porque se omitieron durante las iteraciones de la cola al no ser depositables en ese momento. El m\xe9todo ",(0,o.jsx)(a.code,{children:"normalizeQueue"})," permite a los Operadores de Nodo colocar todas las claves depositables de nuevo en la cola."]}),"\n",(0,o.jsxs)(a.p,{children:["Hay varios punteros con respecto al almacenamiento de datos de dep\xf3sito en CSM. Entre otros, hay punteros ",(0,o.jsx)(a.code,{children:"totalAddedKeys"})," y ",(0,o.jsx)(a.code,{children:"totalVettedKeys"}),". Con el enfoque optimista de aprobaci\xf3n, estos dos punteros deber\xedan estar sincronizados la mayor parte del tiempo (",(0,o.jsx)(a.code,{children:"totalAddedKeys == totalVettedKeys"}),"), dado que no hay informes sobre la presencia de datos de dep\xf3sito inv\xe1lidos. Por lo tanto, hay dos formas en que los datos de dep\xf3sito se pueden colocar en la cola:"]}),"\n",(0,o.jsxs)(a.ul,{children:["\n",(0,o.jsxs)(a.li,{children:["Una vez que se cargan los datos de dep\xf3sito, si ",(0,o.jsx)(a.code,{children:"totalAddedKeys == totalVettedKeys"}),";"]}),"\n",(0,o.jsxs)(a.li,{children:["Despu\xe9s de llamar al m\xe9todo ",(0,o.jsx)(a.a,{href:"https://github.com/lidofinance/community-staking-module/blob/main/src/CSModule.sol#L978",children:(0,o.jsx)(a.code,{children:"normalizeQueue"})}),", en caso de"]}),"\n"]}),"\n",(0,o.jsxs)(a.p,{children:["que algunas claves no se colocaran en la cola al cargarse (",(0,o.jsx)(a.code,{children:"totalAddedKeys != totalVettedKeys"})," en el momento de la carga) o se omitieran durante las iteraciones de la cola;"]}),"\n",(0,o.jsxs)(a.p,{children:["Existe un m\xe9todo para verificar los pr\xf3ximos ",(0,o.jsx)(a.code,{children:"X"}),' elementos y eliminar aquellos que no contienen claves depositables. Este m\xe9todo es necesario para garantizar el funcionamiento de la cola incluso en escenarios catastr\xf3ficos que resulten en una significativa "contaminaci\xf3n" de la cola con claves no depositables.']}),"\n",(0,o.jsx)(a.h2,{id:"eliminaci\xf3n-de-datos-de-dep\xf3sito",children:"Eliminaci\xf3n de datos de dep\xf3sito"}),"\n",(0,o.jsxs)(a.p,{children:["El Operador de Nodo puede eliminar voluntariamente los datos de dep\xf3sito cargados si a\xfan no se han depositado. El ",(0,o.jsx)(a.code,{children:"removalCharge"})," se confisca del colateral del Operador de Nodo en cada clave eliminada para cubrir los costos operativos m\xe1ximos posibles asociados con el procesamiento de la cola. Los datos de dep\xf3sito se pueden eliminar en lotes continuos (por ejemplo, desde el \xedndice 5 hasta el 10)."]}),"\n",(0,o.jsx)(a.p,{children:"Si el protocolo ya ha depositado el validador relacionado con los datos de dep\xf3sito, el Operador de Nodo no puede eliminar los datos de dep\xf3sito. La \xfanica forma de detener los deberes de validaci\xf3n es salir del validador en el CL. Una vez que el validador se retire completamente, el Operador de Nodo puede reclamar el exceso de colateral."}),"\n",(0,o.jsx)(a.h2,{id:"per\xedodo-de-adopci\xf3n-temprana",children:"Per\xedodo de Adopci\xf3n Temprana"}),"\n",(0,o.jsxs)(a.p,{children:['Uno de los desaf\xedos con la entrada sin permisos para los Operadores de Nodo con condiciones atractivas es la posibilidad de que un actor importante ocupe todos los asientos en el m\xf3dulo de participaci\xf3n. Para superar esto, se propone un Per\xedodo de Adopci\xf3n Temprana como la primera etapa del ciclo de vida principal de CSM. Se requiere una prueba de Merkle como boleto de entrada al CSM en la mainnet para unirse durante el Per\xedodo de Adopci\xf3n Temprana. Adem\xe1s de la capacidad para unirse, tales Operadores de Nodo ser\xe1n elegibles para el "descuento de colateral para el primer validador". Esto asegurar\xe1 que durante el Per\xedodo de Adopci\xf3n Temprana, ',(0,o.jsx)(a.a,{href:"https://github.com/lidofinance/community-staking-module/tree/main/artifacts/holesky/early-adoption",children:"validadores solitarios probados"})," podr\xe1n unirse con un peque\xf1o beneficio."]}),"\n",(0,o.jsxs)(a.p,{children:["Consulte el ",(0,o.jsx)(a.a,{href:"https://hackmd.io/@lido/HyKgaBMj6",children:"documento detallado"})," para obtener m\xe1s informaci\xf3n sobre los mecanismos del Per\xedodo de Adopci\xf3n Temprana."]}),"\n",(0,o.jsx)(a.h2,{id:"lecturas-adicionales",children:"Lecturas adicionales"}),"\n",(0,o.jsxs)(a.ul,{children:["\n",(0,o.jsx)(a.li,{children:(0,o.jsx)(a.a,{href:"/staking-modules/csm/rewards",children:"Recompensas"})}),"\n",(0,o.jsx)(a.li,{children:(0,o.jsx)(a.a,{href:"/staking-modules/csm/penalties",children:"Penalizaciones"})}),"\n",(0,o.jsx)(a.li,{children:(0,o.jsx)(a.a,{href:"/staking-modules/csm/validator-exits",children:"Salidas de validadores"})}),"\n"]})]})}function p(e={}){const{wrapper:a}={...(0,s.R)(),...e.components};return a?(0,o.jsx)(a,{...e,children:(0,o.jsx)(c,{...e})}):c(e)}},2973:(e,a,d)=>{d.d(a,{A:()=>o});const o=d.p+"assets/images/join-csm-1-0d4160028c3b5a5ab570a5057990f45e.png"},1766:(e,a,d)=>{d.d(a,{A:()=>o});const o=d.p+"assets/images/join-csm-2-d5e059fd3dc0441b5aa1c53c4d7aaab6.png"},783:(e,a,d)=>{d.d(a,{A:()=>o});const o=d.p+"assets/images/join-csm-3-9b11f664a1de1a98685b297aff004399.png"},4912:(e,a,d)=>{d.d(a,{A:()=>o});const o=d.p+"assets/images/join-csm-4-e16e693d85f61db74fc411e20b02749b.png"},1161:(e,a,d)=>{d.d(a,{A:()=>o});const o=d.p+"assets/images/join-csm-5-518cf6c776afc349ccaf75fcfcf8d868.png"},5074:(e,a,d)=>{d.d(a,{A:()=>o});const o=d.p+"assets/images/join-csm-6-3e7a41f56bbe2a5b6616a659db553616.png"},8453:(e,a,d)=>{d.d(a,{R:()=>i,x:()=>r});var o=d(6540);const s={},n=o.createContext(s);function i(e){const a=o.useContext(n);return o.useMemo((function(){return"function"==typeof e?e(a):{...a,...e}}),[a,e])}function r(e){let a;return a=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:i(e.components),o.createElement(n.Provider,{value:a},e.children)}}}]);