"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[2608],{1091:(e,n,a)=>{a.r(n),a.d(n,{assets:()=>c,contentTitle:()=>o,default:()=>h,frontMatter:()=>r,metadata:()=>d,toc:()=>l});var s=a(4848),i=a(8453);const r={},o="Validator Ejector",d={id:"gu\xedas/validator-ejector-guide",title:"Validator Ejector",description:"Introducci\xf3n",source:"@site/docs/gu\xedas/validator-ejector-guide.md",sourceDirName:"gu\xedas",slug:"/gu\xedas/validator-ejector-guide",permalink:"/lido-docs-spanish/gu\xedas/validator-ejector-guide",draft:!1,unlisted:!1,editUrl:"https://github.com/adminseedlatam/lido-docs-spanish/edit/main/docs/gu\xedas/validator-ejector-guide.md",tags:[],version:"current",frontMatter:{},sidebar:"docs",previous:{title:"Resumen de Herramientas",permalink:"/lido-docs-spanish/gu\xedas/tooling"},next:{title:"Keys API",permalink:"/lido-docs-spanish/gu\xedas/kapi-guide"}},c={},l=[{value:"Introducci\xf3n",id:"introducci\xf3n",level:2},{value:"Requisitos",id:"requisitos",level:2},{value:"Hardware",id:"hardware",level:3},{value:"Nodos",id:"nodos",level:3},{value:"Software",id:"software",level:3},{value:"Utilizando Docker:",id:"utilizando-docker",level:4},{value:"Ejecutando directamente o para encriptaci\xf3n de mensajes:",id:"ejecutando-directamente-o-para-encriptaci\xf3n-de-mensajes",level:4},{value:"Mensajes de Salida",id:"mensajes-de-salida",level:2},{value:"Formato Gen\xe9rico",id:"formato-gen\xe9rico",level:3},{value:"Formato de Salida de ethdo",id:"formato-de-salida-de-ethdo",level:3},{value:"Formato Encriptado",id:"formato-encriptado",level:3},{value:"Encriptaci\xf3n de Mensajes",id:"encriptaci\xf3n-de-mensajes",level:2},{value:"Encriptaci\xf3n usando Ejector - C\xf3digo Fuente",id:"encriptaci\xf3n-usando-ejector---c\xf3digo-fuente",level:3},{value:"Encriptaci\xf3n usando Ejector - Docker",id:"encriptaci\xf3n-usando-ejector---docker",level:3},{value:"Variables de Entorno",id:"variables-de-entorno",level:2},{value:"EXECUTION_NODE",id:"execution_node",level:3},{value:"CONSENSUS_NODE",id:"consensus_node",level:3},{value:"LOCATOR_ADDRESS",id:"locator_address",level:3},{value:"Ejecuci\xf3n",id:"ejecuci\xf3n",level:2},{value:"C\xf3digo Fuente",id:"c\xf3digo-fuente",level:3},{value:"Docker con docker-compose",id:"docker-con-docker-compose",level:3},{value:"Verificaci\xf3n de que Ejector est\xe1 funcionando",id:"verificaci\xf3n-de-que-ejector-est\xe1-funcionando",level:2},{value:"\xbfQu\xe9 hacer si algo est\xe1 mal?",id:"qu\xe9-hacer-si-algo-est\xe1-mal",level:2},{value:"Recursos Adicionales",id:"recursos-adicionales",level:2}];function t(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",li:"li",ol:"ol",p:"p",pre:"pre",ul:"ul",...(0,i.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.h1,{id:"validator-ejector",children:"Validator Ejector"}),"\n",(0,s.jsx)(n.h2,{id:"introducci\xf3n",children:"Introducci\xf3n"}),"\n",(0,s.jsxs)(n.p,{children:["Ejector es un servicio daemon que monitorea los eventos de ",(0,s.jsx)(n.a,{href:"https://github.com/lidofinance/lido-dao/blob/feature/shapella-upgrade/contracts/0.8.9/oracle/ValidatorsExitBusOracle.sol",children:"ValidatorsExitBusOracle"})," y env\xeda mensajes de salida almacenados cuando es necesario. Permite a los Node Operators generar y firmar mensajes de salida con anticipaci\xf3n, los cuales ser\xe1n enviados por Ejector cuando el Protocolo solicite realizar una salida."]}),"\n",(0,s.jsxs)(n.p,{children:["Al iniciar, carga los mensajes de salida desde una carpeta especificada en forma de archivos individuales ",(0,s.jsx)(n.code,{children:".json"})," y valida su formato, estructura y firma. Luego, carga eventos de una cantidad configurable de bloques finalizados m\xe1s recientes, verifica si se deben realizar salidas y peri\xf3dicamente obtiene eventos frescos."]}),"\n",(0,s.jsx)(n.h2,{id:"requisitos",children:"Requisitos"}),"\n",(0,s.jsx)(n.h3,{id:"hardware",children:"Hardware"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"CPU de 2 n\xfacleos"}),"\n",(0,s.jsx)(n.li,{children:"1GB de RAM"}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"nodos",children:"Nodos"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Nodo de Ejecuci\xf3n - ",(0,s.jsx)(n.a,{href:"https://ethereum.org/en/developers/docs/nodes-and-clients/#node-types",children:"Se requiere un nodo completo"})]}),"\n",(0,s.jsx)(n.li,{children:"Nodo de Consenso"}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"software",children:"Software"}),"\n",(0,s.jsx)(n.h4,{id:"utilizando-docker",children:"Utilizando Docker:"}),"\n",(0,s.jsx)(n.p,{children:"Docker + docker-compose."}),"\n",(0,s.jsx)(n.h4,{id:"ejecutando-directamente-o-para-encriptaci\xf3n-de-mensajes",children:"Ejecutando directamente o para encriptaci\xf3n de mensajes:"}),"\n",(0,s.jsx)(n.p,{children:"Node.js 16."}),"\n",(0,s.jsx)(n.h2,{id:"mensajes-de-salida",children:"Mensajes de Salida"}),"\n",(0,s.jsx)(n.p,{children:"Ejector carga y valida los mensajes de salida al inicio. Esto significa que cualquier cambio en la carpeta de mensajes (por ejemplo, nuevos mensajes de salida) requiere un reinicio de la aplicaci\xf3n para ser detectado."}),"\n",(0,s.jsx)(n.p,{children:"Ejector acepta mensajes en tres formatos:"}),"\n",(0,s.jsx)(n.h3,{id:"formato-gen\xe9rico",children:"Formato Gen\xe9rico"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-json",children:'{\n  "message": { "epoch": "123", "validator_index": "123" },\n  "signature": "0x123"\n}\n'})}),"\n",(0,s.jsx)(n.h3,{id:"formato-de-salida-de-ethdo",children:"Formato de Salida de ethdo"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-json",children:'{\n  "exit": {\n    "message": { "epoch": "123", "validator_index": "123" },\n    "signature": "0x123"\n  },\n  "fork_version": "0x123"\n}\n'})}),"\n",(0,s.jsx)(n.h3,{id:"formato-encriptado",children:"Formato Encriptado"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-json",children:'{\n  "version": 4,\n  "uuid": "123abc-123abc-123abc",\n  "path": "",\n  "pubkey": "",\n  "crypto": {\n    "kdf": {\n      "function": "pbkdf2",\n      "params": {\n        "dklen": 123,\n        "c": 123,\n        "prf": "hmac-sha256",\n        "salt": "123abc"\n      },\n      "message": ""\n    },\n    "checksum": {\n      "function": "sha256",\n      "params": {},\n      "message": "123abc"\n    },\n    "cipher": {\n      "function": "aes-128-ctr",\n      "params": { "iv": "123abc" },\n      "message": "123abc"\n    }\n  }\n}\n'})}),"\n",(0,s.jsx)(n.h2,{id:"encriptaci\xf3n-de-mensajes",children:"Encriptaci\xf3n de Mensajes"}),"\n",(0,s.jsxs)(n.p,{children:["Se recomienda encarecidamente que despu\xe9s de generar y firmar los mensajes de salida, se encripten para la seguridad del almacenamiento. Ejector descifrar\xe1 los archivos al inicio buscando la contrase\xf1a en la variable de entorno ",(0,s.jsx)(n.code,{children:"MESSAGES_PASSWORD"}),"."]}),"\n",(0,s.jsxs)(n.p,{children:["Los mensajes de salida se encriptan y descifran siguiendo la especificaci\xf3n ",(0,s.jsx)(n.a,{href:"https://github.com/ethereum/EIPs/blob/master/EIPS/eip-2335.md",children:"EIP-2335"}),"."]}),"\n",(0,s.jsx)(n.p,{children:"Ejector incluye un peque\xf1o y f\xe1cil de usar script de encriptaci\xf3n."}),"\n",(0,s.jsx)(n.h3,{id:"encriptaci\xf3n-usando-ejector---c\xf3digo-fuente",children:"Encriptaci\xf3n usando Ejector - C\xf3digo Fuente"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsx)(n.li,{children:"Clonar el repositorio:"}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"git clone https://github.com/lidofinance/validator-ejector.git\ncd validator-ejector\n"})}),"\n",(0,s.jsxs)(n.ol,{start:"2",children:["\n",(0,s.jsxs)(n.li,{children:["Crear el archivo ",(0,s.jsx)(n.code,{children:".env"})," con la contrase\xf1a de encriptaci\xf3n o pasarla antes del comando:"]}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"MESSAGES_PASSWORD=password\n"})}),"\n",(0,s.jsxs)(n.ol,{start:"3",children:["\n",(0,s.jsxs)(n.li,{children:["Copiar los archivos JSON de mensajes de salida a ",(0,s.jsx)(n.code,{children:"encryptor/input"})]}),"\n",(0,s.jsxs)(n.li,{children:["Ejecutar ",(0,s.jsx)(n.code,{children:"yarn & yarn encrypt"})]}),"\n",(0,s.jsxs)(n.li,{children:["Los archivos de mensajes de salida encriptados se guardar\xe1n en ",(0,s.jsx)(n.code,{children:"encryptor/output"})]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"encriptaci\xf3n-usando-ejector---docker",children:"Encriptaci\xf3n usando Ejector - Docker"}),"\n",(0,s.jsx)(n.p,{children:"Ejector incluye un script de encriptaci\xf3n dentro, por lo que se puede ejecutar usando la misma imagen Docker:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"docker run \\\n\t\t-e MESSAGES_PASSWORD=secret \\\n\t\t-v /full/path/to/input:/app/encryptor/input/ \\\n\t\t-v /full/path/to/output:/app/encryptor/output/ \\\n\t\tlidofinance/validator-ejector@sha256:<hash> \\\n\t\tnode /app/dist/encryptor/encrypt.js\n"})}),"\n",(0,s.jsxs)(n.p,{children:["Puedes encontrar el hash de la versi\xf3n recomendada ",(0,s.jsx)(n.a,{href:"/gu%C3%ADas/tooling",children:"aqu\xed"}),"."]}),"\n",(0,s.jsx)(n.p,{children:"Para plataformas con una arquitectura diferente pero con soporte de emulaci\xf3n/transpilaci\xf3n como macOS en procesadores M, especifica adicionalmente:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"--platform linux/amd64\n"})}),"\n",(0,s.jsx)(n.h2,{id:"variables-de-entorno",children:"Variables de Entorno"}),"\n",(0,s.jsx)(n.h3,{id:"execution_node",children:"EXECUTION_NODE"}),"\n",(0,s.jsx)(n.p,{children:"Direcci\xf3n del Nodo de Ejecuci\xf3n."}),"\n",(0,s.jsx)(n.h3,{id:"consensus_node",children:"CONSENSUS_NODE"}),"\n",(0,s.jsx)(n.p,{children:"Direcci\xf3n del Nodo de Consenso."}),"\n",(0,s.jsx)(n.h3,{id:"locator_address",children:"LOCATOR_ADDRESS"}),"\n",(0,s.jsxs)(n.p,{children:["Direcci\xf3n del contrato ",(0,s.jsx)(n.a,{href:"https://github.com/lidofinance/lido-dao/blob/feature/shapella-upgrade/contracts/0.8.9/LidoLocator.sol",children:"LidoLocator"}),": ",(0,s.jsx)(n.a,{href:"https://docs.lido.fi/deployed-contracts/holesky",children:"Hole\u0161ky"})," / ",(0,s.jsx)(n.a,{href:"https://docs.lido.fi/deployed-contracts/",children:"Mainnet"})]}),"\n",(0,s.jsx)(n.h1,{id:"staking_module_id",children:"STAKING_MODULE_ID"}),"\n",(0,s.jsxs)(n.p,{children:["ID del contrato StakingRouter: ",(0,s.jsx)(n.a,{href:"https://github.com/lidofinance/lido-dao/blob/feature/shapella-upgrade/contracts/0.8.9/StakingRouter.sol",children:"StakingRouter.sol"}),". Actualmente, solo tiene un m\xf3dulo (",(0,s.jsx)(n.a,{href:"https://github.com/lidofinance/lido-dao/blob/feature/shapella-upgrade/contracts/0.4.24/nos/NodeOperatorsRegistry.sol",children:"NodeOperatorsRegistry"}),"), cuyo ID es ",(0,s.jsx)(n.code,{children:"1"}),"."]}),"\n",(0,s.jsx)(n.h1,{id:"operator_id",children:"OPERATOR_ID"}),"\n",(0,s.jsxs)(n.p,{children:["Puedes encontrar este ID en el Panel de Operadores (",(0,s.jsx)(n.code,{children:"#123"})," en la tarjeta del operador): ",(0,s.jsx)(n.a,{href:"https://operators-holesky.testnet.fi",children:"Hole\u0161ky"})," / ",(0,s.jsx)(n.a,{href:"https://operators.lido.fi",children:"Mainnet"}),"."]}),"\n",(0,s.jsx)(n.h1,{id:"messages_location",children:"MESSAGES_LOCATION"}),"\n",(0,s.jsxs)(n.p,{children:["Ubicaci\xf3n desde la cual cargar los mensajes de salida en formato ",(0,s.jsx)(n.code,{children:".json"}),"."]}),"\n",(0,s.jsx)(n.p,{children:"Cuando se establece, activa el modo de mensajes. No es necesario si est\xe1s utilizando Ejector en modo webhook."}),"\n",(0,s.jsxs)(n.p,{children:["Por ejemplo, ",(0,s.jsx)(n.code,{children:"/messages"})," en Docker o simplemente ",(0,s.jsx)(n.code,{children:"messages"})," si se ejecuta directamente para archivos locales."]}),"\n",(0,s.jsx)(n.p,{children:"Tambi\xe9n se admite la URL de un bucket de almacenamiento externo para AWS S3 y Google Cloud Storage:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"s3://"})," para S3"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"gs://"})," para GCS"]}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:["Configuraci\xf3n de autenticaci\xf3n: ",(0,s.jsx)(n.a,{href:"https://cloud.google.com/docs/authentication/application-default-credentials#attached-sa",children:"GCS"}),", ",(0,s.jsx)(n.a,{href:"https://docs.aws.amazon.com/sdk-for-javascript/v3/developer-guide/setting-credentials-node.html",children:"S3"}),"."]}),"\n",(0,s.jsx)(n.h1,{id:"validator_exit_webhook",children:"VALIDATOR_EXIT_WEBHOOK"}),"\n",(0,s.jsx)(n.p,{children:"Endpoint al cual hacer una solicitud cuando se requiere una salida. Permite implementar un enfoque Just-in-Time (JIT) descargando la l\xf3gica de salida a un servicio externo y utilizando Ejector como lector seguro de eventos de salida."}),"\n",(0,s.jsx)(n.p,{children:"Cuando se establece, activa el modo webhook. No es necesario si est\xe1s utilizando Ejector en modo mensajes."}),"\n",(0,s.jsx)(n.p,{children:"En el endpoint, se realizar\xe1 un POST de JSON con la siguiente estructura:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-json",children:'{\n  "validatorIndex": "123",\n  "validatorPubkey": "0x123"\n}\n'})}),"\n",(0,s.jsx)(n.p,{children:"Se considerar\xe1 una salida exitosa si la respuesta es 200, y como fallida si no lo es."}),"\n",(0,s.jsx)(n.h1,{id:"oracle_addresses_allowlist",children:"ORACLE_ADDRESSES_ALLOWLIST"}),"\n",(0,s.jsx)(n.p,{children:"Un array JSON de direcciones de or\xe1culos de Lido, de las cuales solo se aceptar\xe1n transacciones de informe."}),"\n",(0,s.jsxs)(n.p,{children:["Puedes obtener una lista desde Etherscan en ",(0,s.jsx)(n.a,{href:"https://holesky.etherscan.io/address/0xa067FC95c22D51c3bC35fd4BE37414Ee8cc890d2#readContract#F16",children:"Hole\u0161ky"})," o ",(0,s.jsx)(n.a,{href:"https://etherscan.io/address/0xD624B08C83bAECF0807Dd2c6880C3154a5F0B288#readContract#F16",children:"Mainnet"}),"."]}),"\n",(0,s.jsx)(n.p,{children:"Formato:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-json",children:'["0x123", "0x123"]\n'})}),"\n",(0,s.jsx)(n.h1,{id:"messages_password",children:"MESSAGES_PASSWORD"}),"\n",(0,s.jsx)(n.p,{children:"Contrase\xf1a para descifrar los mensajes de salida encriptados al inicio de la aplicaci\xf3n."}),"\n",(0,s.jsx)(n.h1,{id:"messages_password_file",children:"MESSAGES_PASSWORD_FILE"}),"\n",(0,s.jsxs)(n.p,{children:["Alternativa a ",(0,s.jsx)(n.code,{children:"MESSAGES_PASSWORD"}),". Ruta a un archivo con la contrase\xf1a dentro para descifrar los mensajes de salida. Si se utiliza, ",(0,s.jsx)(n.code,{children:"MESSAGES_PASSWORD"})," (no ",(0,s.jsx)(n.code,{children:"MESSAGES_PASSWORD_FILE"}),") debe agregarse a ",(0,s.jsx)(n.code,{children:"LOGGER_SECRETS"})," para que se oculte."]}),"\n",(0,s.jsx)(n.h1,{id:"blocks_preload",children:"BLOCKS_PRELOAD"}),"\n",(0,s.jsx)(n.p,{children:"Cantidad de bloques desde los cuales cargar eventos al iniciar."}),"\n",(0,s.jsx)(n.p,{children:"Se sugiere incluirlo en tus variables de entorno, pero dejar el valor predeterminado de 50000 (~7 d\xedas de bloques)."}),"\n",(0,s.jsx)(n.p,{children:"En caso de una emergencia que requiera que Ejector est\xe9 inactivo, este valor puede ajustarse para permitir cargar una cantidad mayor de bloques al inicio."}),"\n",(0,s.jsx)(n.h1,{id:"http_port",children:"HTTP_PORT"}),"\n",(0,s.jsx)(n.p,{children:"Puerto para servir m\xe9tricas y un punto de verificaci\xf3n de salud. El valor predeterminado es 8989."}),"\n",(0,s.jsx)(n.h1,{id:"run_metrics",children:"RUN_METRICS"}),"\n",(0,s.jsxs)(n.p,{children:["Habilita con ",(0,s.jsx)(n.code,{children:"true"})," para servir m\xe9tricas de Prometheus: ",(0,s.jsx)(n.a,{href:"https://github.com/lidofinance/validator-ejector#metrics",children:"lista completa"}),"."]}),"\n",(0,s.jsxs)(n.p,{children:["Se servir\xe1 en ",(0,s.jsx)(n.code,{children:"HOST:$HTTP_PORT/metrics"}),"."]}),"\n",(0,s.jsx)(n.p,{children:"Altamente recomendado para monitoreo y alertas."}),"\n",(0,s.jsx)(n.h1,{id:"run_health_check",children:"RUN_HEALTH_CHECK"}),"\n",(0,s.jsxs)(n.p,{children:["Habilitado por defecto, deshabilitado con ",(0,s.jsx)(n.code,{children:"false"}),". Altamente recomendado para monitorear este endpoint."]}),"\n",(0,s.jsxs)(n.p,{children:["Se servir\xe1 en ",(0,s.jsx)(n.code,{children:"HOST:$HTTP_PORT/health"}),"."]}),"\n",(0,s.jsx)(n.h1,{id:"logger_level",children:"LOGGER_LEVEL"}),"\n",(0,s.jsxs)(n.p,{children:["Recomendado establecerlo en ",(0,s.jsx)(n.code,{children:"info"})," (predeterminado), puede cambiarse a ",(0,s.jsx)(n.code,{children:"debug"})," en caso de problemas para facilitar la depuraci\xf3n."]}),"\n",(0,s.jsx)(n.h1,{id:"logger_format",children:"LOGGER_FORMAT"}),"\n",(0,s.jsxs)(n.p,{children:["Formato de los logs, por defecto es ",(0,s.jsx)(n.code,{children:"simple"}),", pero puede establecerse en ",(0,s.jsx)(n.code,{children:"json"})," para que sea f\xe1cilmente interpretable por ",(0,s.jsx)(n.a,{href:"https://github.com/grafana/loki",children:"Loki"}),", por ejemplo."]}),"\n",(0,s.jsx)(n.h1,{id:"logger_secrets",children:"LOGGER_SECRETS"}),"\n",(0,s.jsx)(n.p,{children:"Nombres de variables de entorno o valores exactos que deben reemplazarse en los logs, en formato de array JSON de cadenas."}),"\n",(0,s.jsxs)(n.p,{children:["Se recomienda incluir tu ",(0,s.jsx)(n.code,{children:"MESSAGES_PASSWORD"}),", ",(0,s.jsx)(n.code,{children:"EXECUTION_NODE"}),", y ",(0,s.jsx)(n.code,{children:"CONSENSUS_NODE"}),":"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-json",children:'["MESSAGES_PASSWORD", "EXECUTION_NODE", "CONSENSUS_NODE"]\n'})}),"\n",(0,s.jsx)(n.p,{children:"Aseg\xfarate de copiar correctamente las comillas si copias este ejemplo."}),"\n",(0,s.jsx)(n.h1,{id:"dry_run",children:"DRY_RUN"}),"\n",(0,s.jsxs)(n.p,{children:["Permite probar la aplicaci\xf3n con ",(0,s.jsx)(n.code,{children:"true"})," sin enviar realmente mensajes de salida."]}),"\n",(0,s.jsx)(n.p,{children:"\xa1\xdasalo con precauci\xf3n!"}),"\n",(0,s.jsxs)(n.p,{children:["Aseg\xfarate de establecerlo en ",(0,s.jsx)(n.code,{children:"false"})," o de eliminarlo completamente en producci\xf3n."]}),"\n",(0,s.jsx)(n.h1,{id:"par\xe1metros-avanzados",children:"Par\xe1metros Avanzados"}),"\n",(0,s.jsx)(n.p,{children:"Por favor, no los utilices a menos que lo sugiera un contribuidor de Lido."}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"BLOCKS_LOOP - 900 (3 horas de bloques) - Cantidad de bloques que Ejector observa en trabajos de sondeo al despertar."}),"\n",(0,s.jsx)(n.li,{children:"JOB_INTERVAL - 384000 (1 epoch) - Tiempo que Ejector duerme entre trabajos."}),"\n",(0,s.jsxs)(n.li,{children:["DISABLE_SECURITY_DONT_USE_IN_PRODUCTION - false - Establecer en ",(0,s.jsx)(n.code,{children:"true"})," para omitir controles de seguridad, por ejemplo, si el contrato de Consenso de Bus de Salida fue cambiado despu\xe9s de que Ejector no pudiera salir de los validadores, por ejemplo, si fue desactivado."]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"ejecuci\xf3n",children:"Ejecuci\xf3n"}),"\n",(0,s.jsx)(n.h3,{id:"c\xf3digo-fuente",children:"C\xf3digo Fuente"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsx)(n.li,{children:"Clona el repositorio:"}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"git clone https://github.com/lidofinance/validator-ejector.git\ncd validator-ejector\n"})}),"\n",(0,s.jsxs)(n.ol,{start:"2",children:["\n",(0,s.jsxs)(n.li,{children:["Crea una carpeta de mensajes de salida, por ejemplo, localmente ",(0,s.jsx)(n.code,{children:"mkdir messages"}),"."]}),"\n",(0,s.jsx)(n.li,{children:"Coloca los archivos de mensajes de salida en la carpeta de mensajes."}),"\n",(0,s.jsxs)(n.li,{children:["Copia el archivo de ejemplo de env: ",(0,s.jsx)(n.code,{children:"cp sample.env .env"}),"."]}),"\n",(0,s.jsxs)(n.li,{children:["Llena las variables de entorno en el archivo ",(0,s.jsx)(n.code,{children:".env"}),"."]}),"\n",(0,s.jsx)(n.li,{children:"Ejecuta:"}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"yarn\nyarn build\nyarn start\n"})}),"\n",(0,s.jsx)(n.h3,{id:"docker-con-docker-compose",children:"Docker con docker-compose"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsx)(n.li,{children:"Crea una carpeta ra\xedz para Ejector, y entra en esa carpeta."}),"\n",(0,s.jsxs)(n.li,{children:["Crea una carpeta de mensajes de salida ",(0,s.jsx)(n.code,{children:"mkdir messages"}),"."]}),"\n",(0,s.jsx)(n.li,{children:"Coloca los archivos de mensajes de salida en la carpeta de mensajes."}),"\n",(0,s.jsxs)(n.li,{children:["Copia el archivo de env: ",(0,s.jsx)(n.code,{children:"cp sample.env .env"}),"."]}),"\n",(0,s.jsxs)(n.li,{children:["Crea un archivo ",(0,s.jsx)(n.code,{children:"docker-compose.yml"})," utilizando la siguiente plantilla:"]}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.a,{href:"https://github.com/lidofinance/validator-ejector/blob/develop/docker-compose.yml",children:"https://github.com/lidofinance/validator-ejector/blob/develop/docker-compose.yml"})}),"\n",(0,s.jsxs)(n.ol,{start:"6",children:["\n",(0,s.jsxs)(n.li,{children:["Ejecuta ",(0,s.jsx)(n.code,{children:"docker-compose up"})," o ",(0,s.jsx)(n.code,{children:"docker-compose up -d"})," para iniciar en modo desacoplado (en segundo plano)."]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"verificaci\xf3n-de-que-ejector-est\xe1-funcionando",children:"Verificaci\xf3n de que Ejector est\xe1 funcionando"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsx)(n.li,{children:"Aseg\xfarate de que no haya errores en los logs y de que no haya reinicios."}),"\n",(0,s.jsx)(n.li,{children:"Verifica que la configuraci\xf3n registrada al inicio sea correcta en los logs."}),"\n",(0,s.jsxs)(n.li,{children:["Si has colocado mensajes prefirmados en la carpeta de mensajes, aseg\xfarate de que el recuento de mensajes cargados sea mayor que ",(0,s.jsx)(n.code,{children:"0"}),"."]}),"\n",(0,s.jsxs)(n.li,{children:["Aseg\xfarate de ver l\xedneas como ",(0,s.jsx)(n.code,{children:"Job started"})," y ",(0,s.jsx)(n.code,{children:"Job finished"})," en los logs."]}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"Ejemplo de logs de operaci\xf3n correcta:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:'info: Application started, version 1.0.0 {"EXECUTION_NODE":"<secret>","CONSENSUS_NODE":"<secret>","LOCATOR_ADDRESS":"0x123","STAKING_MODULE_ID":"1","OPERATOR_ID":"0","MESSAGES_LOCATION":"messages","ORACLE_ADDRESSES_ALLOWLIST":["0x123"],"MESSAGES_PASSWORD":"<secret>","BLOCKS_PRELOAD":190000,"BLOCKS_LOOP":64,"JOB_INTERVAL":384000,"HTTP_PORT":8989,"RUN_METRICS":true,"RUN_HEALTH_CHECK":true,"DRY_RUN":false}\ninfo: Loading messages from messages\ninfo: Loaded 123 messages\ninfo: Validating messages\ninfo: Starting, searching only for requests for operator 0\ninfo: Loading initial events for 190000 last blocks\ninfo: Job started {"operatorId":"0","stakingModuleId":"1","loadedMessages":123}\ninfo: Resolved Exit Bus contract address using the Locator {"exitBusAddress":"0x123"}\ninfo: Resolved Consensus contract address {"consensusAddress":"0x123"}\ninfo: Fetched the latest block from EL {"latestBlock":12345}\ninfo: Fetching request events from the Exit Bus {"eventsNumber":190000,"fromBlock":12345,"toBlock":12345}\ninfo\n\n: Loaded ValidatorExitRequest events {"amount":0}\ninfo: Handling ejection requests {"amount":0}\ninfo: Job finished\ninfo: Starting 384 seconds polling for 64 last blocks\n'})}),"\n",(0,s.jsx)(n.h2,{id:"qu\xe9-hacer-si-algo-est\xe1-mal",children:"\xbfQu\xe9 hacer si algo est\xe1 mal?"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsx)(n.li,{children:"Aseg\xfarate de que la configuraci\xf3n sea correcta."}),"\n",(0,s.jsx)(n.li,{children:"Aseg\xfarate de estar usando el hash SHA o la versi\xf3n recomendada de la imagen Docker."}),"\n",(0,s.jsx)(n.li,{children:"Verifica que los nodos est\xe9n sincronizados y funcionando correctamente."}),"\n",(0,s.jsx)(n.li,{children:"Reinicia la aplicaci\xf3n."}),"\n",(0,s.jsxs)(n.li,{children:["Inicia la aplicaci\xf3n con la variable de entorno ",(0,s.jsx)(n.code,{children:"LOGGER_LEVEL=debug"})," y contacta a los desarrolladores de Lido con los logs para investigar el problema."]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"recursos-adicionales",children:"Recursos Adicionales"}),"\n",(0,s.jsxs)(n.p,{children:["Repositorio GitHub de Validator Ejector (Open Source)\n",(0,s.jsx)(n.a,{href:"https://github.com/lidofinance/validator-ejector",children:"https://github.com/lidofinance/validator-ejector"})]}),"\n",(0,s.jsxs)(n.p,{children:["Retiros de Lido: Automatizaci\xf3n de Salidas de Validador - algunas partes pueden estar desactualizadas\n",(0,s.jsx)(n.a,{href:"https://hackmd.io/@lido/BkxRxAr-o",children:"https://hackmd.io/@lido/BkxRxAr-o"})]}),"\n",(0,s.jsxs)(n.p,{children:["Especificaci\xf3n de la L\xf3gica de Ejector - algunas partes pueden estar desactualizadas\n",(0,s.jsx)(n.a,{href:"https://hackmd.io/@lido/r1KZ4YNdj",children:"https://hackmd.io/@lido/r1KZ4YNdj"})]})]})}function h(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(t,{...e})}):t(e)}},8453:(e,n,a)=>{a.d(n,{R:()=>o,x:()=>d});var s=a(6540);const i={},r=s.createContext(i);function o(e){const n=s.useContext(r);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function d(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:o(e.components),s.createElement(r.Provider,{value:n},e.children)}}}]);